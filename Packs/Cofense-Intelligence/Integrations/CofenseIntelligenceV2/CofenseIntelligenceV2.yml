commonfields:
  id: CofenseIntelligenceV2
  version: -1
name: CofenseIntelligenceV2
display: CofenseIntelligence v2
category: Utilities
description: 'Use the Cofense Intelligence integration to check the reputation of
  URLs, IP addresses, file hashes, and email addresses.'
configuration:
- display: Server URL
  name: url
  defaultvalue: https://www.threathq.com/apiv1
  type: 0
  required: true
- display: Token Name
  displaypassword: Password
  name: credentials
  type: 9
  required: true
- display: Source Reliability
  name: integration_reliability
  defaultvalue: B - Usually reliable
  type: 15
  required: false
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  additionalinfo: Reliability of the source providing the intelligence data.
- display: IP Threshold
  name: ip_threshold
  defaultvalue: Major
  type: 15
  required: false
  options:
  - None
  - Minor
  - Moderate
  - Major
  additionalinfo: Threshold for IP reletad threats' severity.
- display: File Threshold
  name: file_threshold
  defaultvalue: Major
  type: 15
  required: false
  options:
  - None
  - Minor
  - Moderate
  - Major
  additionalinfo: Threshold for file reletad threats' severity.
- display: URL Threshold
  name: url_threshold
  defaultvalue: Major
  type: 15
  required: false
  options:
  - None
  - Minor
  - Moderate
  - Major
  additionalinfo: Threshold for URL reletad threats' severity.
- display: Email Threshold
  name: email_threshold
  defaultvalue: Major
  type: 15
  required: false
  options:
  - None
  - Minor
  - Moderate
  - Major
  additionalinfo: Threshold for email reletad threats' severity.
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
script:
  script: '-'
  type: python
  commands:
  - name: ip
    arguments:
    - name: ip
      required: true
      default: true
      description: IP address to check.
      isArray: false
    description: Checks the reputation of an IP address.
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Reliability
      description: The actual score.
      type: string
    - contextPath: CofenseIntelligence.Threat.id
      description: 'Threat ID'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.id
      description: 'Integer identifier for this feed'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.WRITE
      description: 'True if you are allowed to submit data to this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.OWNER
      description: 'True if you are the original provider of the source data for this
        feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.READ
      description: 'True if you are allowed to view data for this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.displayName
      description: 'Human readable name for this feed'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.familyName
      description: 'Names and describes malware families'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.description
      description: 'Brief description of the malware family, what it does, or how
        it works'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.impact
      description: 'Values borrowed from stixVocabs:ImpactRatingVocab-1.0'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.confidence
      description: 'level of confidence in the threats block'
      type: Number
    - contextPath: CofenseIntelligence.Threat.blockSet.blockType
      description: 'Data type of the watchlist item'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.roleDescription
      description: 'Description of infrastructure type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.role
      description: 'Infrastructure Type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.infrastructureTypeSubclass.description
      description: 'Brief description of infrastructure type being used'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data
      description: 'Domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data_1
      description: 'Either a domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.totalCount
      description: 'Number of individual messages associated with this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.id
      description: 'Numeric identifier used by Malcovery to track this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.text
      description: 'String identifier used by Malcovery to track this brand'
      type: String
    - contextPath: CofenseIntelligence.Threat.domainSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.domainSet.domain
      description: 'Sender domain name'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.senderEmail
      description: 'The possibly spoofed email address used in the delivery of the
        email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.description
      description: 'Names and describes malware families.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.detected
      description: 'Was executable detected?'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.threatVendorName
      description: 'Name of antivirus vendor'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileName
      description: 'The file name of any file discovered during a malware infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.type
      description: 'Description of the purpose this file serves within the malware
        infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.dateEntered
      description: 'Date when this file was analyzed by Malcovery'
      type: Date
    - contextPath: CofenseIntelligence.Threat.executableSet.severityLevel
      description: 'The malware infection severity level'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileNameExtension
      description: 'extension of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.md5Hex
      description: 'The md5 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha384Hex
      description: 'The SHA-384 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha512Hex
      description: 'The SHA-512 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha1Hex
      description: 'The SHA-1 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha224Hex
      description: 'The SHA-224 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha256Hex
      description: 'The SHA-256 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.executableSubtype.description
      description: 'description of the executable file'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderIpSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderIpSet.ip
      description: 'One of possibly many IPs used in the delivery of the email'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderNameSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderNameSet.name
      description: 'This is the friendly name of the sender of the email'
      type: String
    - contextPath: CofenseIntelligence.Threat.subjectSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.subjectSet.subject
      description: 'Email subject line'
      type: String
    - contextPath: CofenseIntelligence.Threat.lastPublished
      description: 'Timestamp of when this campaign was most recently updated'
      type: Date
    - contextPath: CofenseIntelligence.Threat.firstPublished
      description: 'Timestamp of when this campaign was initially published'
      type: Date
    - contextPath: CofenseIntelligence.Threat.label
      description: 'Human readable name for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.executiveSummary
      description: 'Analyst written summary of the campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.hasReport
      description: 'Flag to show whether this campaign has a written report associated
        with it'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.reportURL
      description: 'Direct URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.apiReportURL
      description: 'URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatDetailURL
      description: 'T3 Report URL'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.description
      description: 'Set of malware family'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatType
      description: 'This will only have one value for malware'
      type: String
  - name: cofense-search
    arguments:
    - name: str
      required: true
      default: true
      description: String to search.
    - name: limit
      description: 'Maximum number of strings to search. Default is 10.'
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Reliability
      description: The actual score.
      type: string
    - contextPath: CofenseIntelligence.Threat.id
      description: 'Threat ID'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.id
      description: 'Integer identifier for this feed'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.WRITE
      description: 'True if you are allowed to submit data to this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.OWNER
      description: 'True if you are the original provider of the source data for this
        feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.READ
      description: 'True if you are allowed to view data for this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.displayName
      description: 'Human readable name for this feed'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.familyName
      description: 'Names and describes malware families'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.description
      description: 'Brief description of the malware family, what it does, or how
        it works'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.impact
      description: 'Values borrowed from stixVocabs:ImpactRatingVocab-1.0'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.confidence
      description: 'level of confidence in the threats block'
      type: Number
    - contextPath: CofenseIntelligence.Threat.blockSet.blockType
      description: 'Data type of the watchlist item'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.roleDescription
      description: 'Description of infrastructure type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.role
      description: 'Infrastructure Type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.infrastructureTypeSubclass.description
      description: 'Brief description of infrastructure type being used'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data
      description: 'Domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data_1
      description: 'Either a domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.totalCount
      description: 'Number of individual messages associated with this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.id
      description: 'Numeric identifier used by Malcovery to track this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.text
      description: 'String identifier used by Malcovery to track this brand'
      type: String
    - contextPath: CofenseIntelligence.Threat.domainSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.domainSet.domain
      description: 'Sender domain name'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.senderEmail
      description: 'The possibly spoofed email address used in the delivery of the
        email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.description
      description: 'Names and describes malware families.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.detected
      description: 'Was executable detected?'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.threatVendorName
      description: 'Name of antivirus vendor'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileName
      description: 'The file name of any file discovered during a malware infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.type
      description: 'Description of the purpose this file serves within the malware
        infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.dateEntered
      description: 'Date when this file was analyzed by Malcovery'
      type: Date
    - contextPath: CofenseIntelligence.Threat.executableSet.severityLevel
      description: 'The malware infection severity level'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileNameExtension
      description: 'extension of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.md5Hex
      description: 'The md5 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha384Hex
      description: 'The SHA-384 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha512Hex
      description: 'The SHA-512 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha1Hex
      description: 'The SHA-1 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha224Hex
      description: 'The SHA-224 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha256Hex
      description: 'The SHA-256 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.executableSubtype.description
      description: 'description of the executable file'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderIpSet.totalCount
      description: 'Count of the instances of each item named.'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderIpSet.ip
      description: 'One of possibly many IPs used in the delivery of the email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderNameSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderNameSet.name
      description: 'This is the friendly name of the sender of the email'
      type: String
    - contextPath: CofenseIntelligence.Threat.subjectSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.subjectSet.subject
      description: 'Email subject line'
      type: String
    - contextPath: CofenseIntelligence.Threat.lastPublished
      description: 'Timestamp of when this campaign was most recently updated'
      type: Date
    - contextPath: CofenseIntelligence.Threat.firstPublished
      description: 'Timestamp of when this campaign was initially published'
      type: Date
    - contextPath: CofenseIntelligence.Threat.label
      description: 'Human readable name for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.executiveSummary
      description: 'Analyst written summary of the campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.hasReport
      description: 'Flag to show whether this campaign has a written report associated
        with it'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.reportURL
      description: 'Direct URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.apiReportURL
      description: 'URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatDetailURL
      description: 'T3 Report URL'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.description
      description: 'Set of malware family'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatType
      description: 'This will only have one value for malware'
      type: String
    description: Searches for extracted strings identified within malware campaigns.
  - name: file
    arguments:
    - name: file
      required: true
      default: true
      description: A CSV list of file hashes to check (MD5, SHA1, or SHA256).
      isArray: false
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Reliability
      description: The actual score.
      type: string
    - contextPath: CofenseIntelligence.Threat.id
      description: 'Threat ID'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.id
      description: 'Integer identifier for this feed'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.WRITE
      description: 'True if you are allowed to submit data to this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.OWNER
      description: 'True if you are the original provider of the source data for this
        feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.READ
      description: 'True if you are allowed to view data for this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.displayName
      description: 'Human readable name for this feed'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.familyName
      description: 'Names and describes malware families'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.description
      description: 'Brief description of the malware family, what it does, or how
        it works'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.impact
      description: 'Values borrowed from stixVocabs:ImpactRatingVocab-1.0'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.confidence
      description: 'level of confidence in the threats block'
      type: Number
    - contextPath: CofenseIntelligence.Threat.blockSet.blockType
      description: 'Data type of the watchlist item'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.roleDescription
      description: 'Description of infrastructure type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.role
      description: 'Infrastructure Type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.infrastructureTypeSubclass.description
      description: 'Brief description of infrastructure type being used'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data
      description: 'Domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data_1
      description: 'Either a domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.totalCount
      description: 'Number of individual messages associated with this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.id
      description: 'Numeric identifier used by Malcovery to track this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.text
      description: 'String identifier used by Malcovery to track this brand'
      type: String
    - contextPath: CofenseIntelligence.Threat.domainSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.domainSet.domain
      description: 'Sender domain name'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.senderEmail
      description: 'The possibly spoofed email address used in the delivery of the
        email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.description
      description: 'Names and describes malware families.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.detected
      description: 'Was executable detected?'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.threatVendorName
      description: 'Name of antivirus vendor'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileName
      description: 'The file name of any file discovered during a malware infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.type
      description: 'Description of the purpose this file serves within the malware
        infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.dateEntered
      description: 'Date when this file was analyzed by Malcovery'
      type: Date
    - contextPath: CofenseIntelligence.Threat.executableSet.severityLevel
      description: 'The malware infection severity level'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileNameExtension
      description: 'extension of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.md5Hex
      description: 'The md5 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha384Hex
      description: 'The SHA-384 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha512Hex
      description: 'The SHA-512 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha1Hex
      description: 'The SHA-1 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha224Hex
      description: 'The SHA-224 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha256Hex
      description: 'The SHA-256 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.executableSubtype.description
      description: 'description of the executable file'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderIpSet.totalCount
      description: 'Count of the instances of each item named.'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderIpSet.ip
      description: 'One of possibly many IPs used in the delivery of the email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderNameSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderNameSet.name
      description: 'This is the friendly name of the sender of the email'
      type: String
    - contextPath: CofenseIntelligence.Threat.subjectSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.subjectSet.subject
      description: 'Email subject line'
      type: String
    - contextPath: CofenseIntelligence.Threat.lastPublished
      description: 'Timestamp of when this campaign was most recently updated'
      type: Date
    - contextPath: CofenseIntelligence.Threat.firstPublished
      description: 'Timestamp of when this campaign was initially published'
      type: Date
    - contextPath: CofenseIntelligence.Threat.label
      description: 'Human readable name for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.executiveSummary
      description: 'Analyst written summary of the campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.hasReport
      description: 'Flag to show whether this campaign has a written report associated
        with it'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.reportURL
      description: 'Direct URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.apiReportURL
      description: 'URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatDetailURL
      description: 'T3 Report URL'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.description
      description: 'Set of malware family'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatType
      description: 'This will only have one value for malware'
      type: String
    description: Checks the reputation of a file hash.
  - name: email
    arguments:
    - name: email
      required: true
      default: true
      description: Sender email address to check.
      isArray: false
    description: Checks the reputation of an email address.
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Reliability
      description: The actual score.
      type: string
    - contextPath: CofenseIntelligence.Threat.id
      description: 'Threat ID'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.id
      description: 'Integer identifier for this feed'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.WRITE
      description: 'True if you are allowed to submit data to this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.OWNER
      description: 'True if you are the original provider of the source data for this
        feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.READ
      description: 'True if you are allowed to view data for this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.displayName
      description: 'Human readable name for this feed'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.familyName
      description: 'Names and describes malware families'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.description
      description: 'Brief description of the malware family, what it does, or how
        it works'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.impact
      description: 'Values borrowed from stixVocabs:ImpactRatingVocab-1.0'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.confidence
      description: 'level of confidence in the threats block'
      type: Number
    - contextPath: CofenseIntelligence.Threat.blockSet.blockType
      description: 'Data type of the watchlist item'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.roleDescription
      description: 'Description of infrastructure type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.role
      description: 'Infrastructure Type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.infrastructureTypeSubclass.description
      description: 'Brief description of infrastructure type being used'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data
      description: 'Domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data_1
      description: 'Either a domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.totalCount
      description: 'Number of individual messages associated with this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.id
      description: 'Numeric identifier used by Malcovery to track this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.text
      description: 'String identifier used by Malcovery to track this brand'
      type: String
    - contextPath: CofenseIntelligence.Threat.domainSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.domainSet.domain
      description: 'Sender domain name'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.senderEmail
      description: 'The possibly spoofed email address used in the delivery of the
        email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.description
      description: 'Names and describes malware families.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.detected
      description: 'Was executable detected?'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.threatVendorName
      description: 'Name of antivirus vendor'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileName
      description: 'The file name of any file discovered during a malware infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.type
      description: 'Description of the purpose this file serves within the malware
        infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.dateEntered
      description: 'Date when this file was analyzed by Malcovery'
      type: Date
    - contextPath: CofenseIntelligence.Threat.executableSet.severityLevel
      description: 'The malware infection severity level'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileNameExtension
      description: 'extension of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.md5Hex
      description: 'The md5 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha384Hex
      description: 'The SHA-384 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha512Hex
      description: 'The SHA-512 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha1Hex
      description: 'The SHA-1 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha224Hex
      description: 'The SHA-224 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha256Hex
      description: 'The SHA-256 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.executableSubtype.description
      description: 'description of the executable file'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderIpSet.totalCount
      description: 'Count of the instances of each item named.'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderIpSet.ip
      description: 'One of possibly many IPs used in the delivery of the email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderNameSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderNameSet.name
      description: 'This is the friendly name of the sender of the email'
      type: String
    - contextPath: CofenseIntelligence.Threat.subjectSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.subjectSet.subject
      description: 'Email subject line'
      type: String
    - contextPath: CofenseIntelligence.Threat.lastPublished
      description: 'Timestamp of when this campaign was most recently updated'
      type: Date
    - contextPath: CofenseIntelligence.Threat.firstPublished
      description: 'Timestamp of when this campaign was initially published'
      type: Date
    - contextPath: CofenseIntelligence.Threat.label
      description: 'Human readable name for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.executiveSummary
      description: 'Analyst written summary of the campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.hasReport
      description: 'Flag to show whether this campaign has a written report associated
        with it'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.reportURL
      description: 'Direct URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.apiReportURL
      description: 'URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatDetailURL
      description: 'T3 Report URL'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.description
      description: 'Set of malware family'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatType
      description: 'This will only have one value for malware'
      type: String
  - name: url
    arguments:
    - name: url
      required: true
      default: true
      description: URL to check.
      isArray: false
    description: Checks the reputation of a URL.
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Reliability
      description: The actual score.
      type: string
    - contextPath: CofenseIntelligence.Threat.id
      description: 'Threat ID'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.id
      description: 'Integer identifier for this feed'
      type: Number
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.WRITE
      description: 'True if you are allowed to submit data to this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.OWNER
      description: 'True if you are the original provider of the source data for this
        feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.permissions.READ
      description: 'True if you are allowed to view data for this feed'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.feeds.displayName
      description: 'Human readable name for this feed'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.familyName
      description: 'Names and describes malware families'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.malwareFamily.description
      description: 'Brief description of the malware family, what it does, or how
        it works'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.impact
      description: 'Values borrowed from stixVocabs:ImpactRatingVocab-1.0'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.confidence
      description: 'level of confidence in the threats block'
      type: Number
    - contextPath: CofenseIntelligence.Threat.blockSet.blockType
      description: 'Data type of the watchlist item'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.roleDescription
      description: 'Description of infrastructure type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.role
      description: 'Infrastructure Type'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.infrastructureTypeSubclass.description
      description: 'Brief description of infrastructure type being used'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data
      description: 'Domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.blockSet.data_1
      description: 'Either a domain name or an IP address'
      type: String
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.totalCount
      description: 'Number of individual messages associated with this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.id
      description: 'Numeric identifier used by Malcovery to track this brand'
      type: Number
    - contextPath: CofenseIntelligence.Threat.campaignBrandSet.brand.text
      description: 'String identifier used by Malcovery to track this brand'
      type: String
    - contextPath: CofenseIntelligence.Threat.domainSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.domainSet.domain
      description: 'Sender domain name'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderEmailSet.senderEmail
      description: 'The possibly spoofed email address used in the delivery of the
        email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.malwareFamily.description
      description: 'Names and describes malware families.'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.detected
      description: 'Was executable detected?'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.executableSet.vendorDetections.threatVendorName
      description: 'Name of antivirus vendor'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileName
      description: 'The file name of any file discovered during a malware infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.type
      description: 'Description of the purpose this file serves within the malware
        infection'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.dateEntered
      description: 'Date when this file was analyzed by Malcovery'
      type: Date
    - contextPath: CofenseIntelligence.Threat.executableSet.severityLevel
      description: 'The malware infection severity level'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.fileNameExtension
      description: 'extension of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.md5Hex
      description: 'The md5 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha384Hex
      description: 'The SHA-384 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha512Hex
      description: 'The SHA-512 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha1Hex
      description: 'The SHA-1 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha224Hex
      description: 'The SHA-224 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.sha256Hex
      description: 'The SHA-256 hash of the file'
      type: String
    - contextPath: CofenseIntelligence.Threat.executableSet.executableSubtype.description
      description: 'description of the executable file'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderIpSet.totalCount
      description: 'Count of the instances of each item named.'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderIpSet.ip
      description: 'One of possibly many IPs used in the delivery of the email.'
      type: String
    - contextPath: CofenseIntelligence.Threat.senderNameSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.senderNameSet.name
      description: 'This is the friendly name of the sender of the email'
      type: String
    - contextPath: CofenseIntelligence.Threat.subjectSet.totalCount
      description: 'Count of the instances of each item named'
      type: Number
    - contextPath: CofenseIntelligence.Threat.subjectSet.subject
      description: 'Email subject line'
      type: String
    - contextPath: CofenseIntelligence.Threat.lastPublished
      description: 'Timestamp of when this campaign was most recently updated'
      type: Date
    - contextPath: CofenseIntelligence.Threat.firstPublished
      description: 'Timestamp of when this campaign was initially published'
      type: Date
    - contextPath: CofenseIntelligence.Threat.label
      description: 'Human readable name for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.executiveSummary
      description: 'Analyst written summary of the campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.hasReport
      description: 'Flag to show whether this campaign has a written report associated
        with it'
      type: Boolean
    - contextPath: CofenseIntelligence.Threat.reportURL
      description: 'Direct URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.apiReportURL
      description: 'URL to human readable report for this campaign'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatDetailURL
      description: 'T3 Report URL'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.familyName
      description: 'Family name of malware'
      type: String
    - contextPath: CofenseIntelligence.Threat.malwareFamilySet.description
      description: 'Set of malware family'
      type: String
    - contextPath: CofenseIntelligence.Threat.threatType
      description: 'This will only have one value for malware'
      type: String
  dockerimage: demisto/python3:3.9.5.20070
  runonce: false
  subtype: python3
tests:
- Cofense Intelligence v2 test
fromversion: 5.5.0
