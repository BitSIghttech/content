id: Endpoint Malware Investigation - Generic V2
version: -1
contentitemexportablefields:
  contentitemfields: {}
name: Endpoint Malware Investigation - Generic V2
description: "This playbook provides a framework for handling malware investigation\
  \ through all essential steps, the playbook consists of 7 stages when each stage\
  \ contains the relevant playbook or tasks. \nThis playbook will auto extract indicators\
  \ from incidents by indicators extraction rules of malware incident type.\nIf you\
  \ wish to use Illusive integration in the `Forensics - Generic` playbook please\
  \ note that you will able to set forensic timeline by editing the `Forensics - Generic`\
  \ playbook inputs.  \n    "
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 485b00ff-6655-4a20-8fd6-f40ce5b43d80
    type: start
    task:
      id: 485b00ff-6655-4a20-8fd6-f40ce5b43d80
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "113"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": -3260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: f8f052e5-1335-4cf0-8ad1-24fb809b3d63
    type: title
    task:
      id: f8f052e5-1335-4cf0-8ad1-24fb809b3d63
      version: -1
      name: Detonation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "67"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": -560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: a92117d3-1ccf-4dc8-833a-01ac2d172cad
    type: title
    task:
      id: a92117d3-1ccf-4dc8-833a-01ac2d172cad
      version: -1
      name: File enrichment
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 230,
          "y": -560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 89dabb98-4cdf-4ea6-87e4-cf5e4c935911
    type: title
    task:
      id: 89dabb98-4cdf-4ea6-87e4-cf5e4c935911
      version: -1
      name: Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "68"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 8bc813e6-4731-4348-8a93-9ab9de5b28f1
    type: title
    task:
      id: 8bc813e6-4731-4348-8a93-9ab9de5b28f1
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 5590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: e85c9761-257f-4461-88f7-c094e476abd7
    type: condition
    task:
      id: e85c9761-257f-4461-88f7-c094e476abd7
      version: -1
      name: Manual - Get analyst approval for auto-remediation
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "41"
      "Yes":
      - "115"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 5730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 7d6c7837-c713-4066-839c-4766a2c9f299
    type: regular
    task:
      id: 7d6c7837-c713-4066-839c-4766a2c9f299
      version: -1
      name: Analyst review of the investigation
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 72f2ca46-f3c7-48d2-87f2-f9c9989806bb
    type: regular
    task:
      id: 72f2ca46-f3c7-48d2-87f2-f9c9989806bb
      version: -1
      name: Manual - Unisolate endpoints
      description: Unisolate endpoints that were isolated during the investigation
        after remediation.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -70,
          "y": 6700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: daedcf8c-3f0b-4294-8d19-bd20e715173b
    type: playbook
    task:
      id: daedcf8c-3f0b-4294-8d19-bd20e715173b
      version: -1
      name: Endpoint Enrichment - Generic v2.1
      description: |-
        Enrich an endpoint by hostname using one or more integrations.
        Supported integrations:
        - Active Directory Query v2
        - McAfee ePolicy Orchestrator
        - Carbon Black Enterprise Response v2
        - Cylance Protect v2
        - CrowdStrike Falcon Host
        - ExtraHop Reveal(x)
      playbookName: Endpoint Enrichment - Generic v2.1
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "108"
    scriptarguments:
      Hostname:
        complex:
          root: Endpoint
          accessor: Hostname
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 490,
          "y": -1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: b1eef12c-c3f8-44e8-81d1-df927bb4d3c0
    type: playbook
    task:
      id: b1eef12c-c3f8-44e8-81d1-df927bb4d3c0
      version: -1
      name: File Enrichment - Generic v2
      description: |-
        Enrich a file using one or more integrations.

        - Provide threat information
      playbookName: File Enrichment - Generic v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "100"
    scriptarguments:
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 230,
          "y": -425
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: 24e1d618-d35b-4854-84d3-7da47e668836
    type: playbook
    task:
      id: 24e1d618-d35b-4854-84d3-7da47e668836
      version: -1
      name: Detonate File - Generic
      description: Detonate file through active integrations that support file detonation
      playbookName: Detonate File - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "100"
    scriptarguments:
      EntryID:
        complex:
          root: File
          accessor: EntryID
      File:
        complex:
          root: File
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 790,
          "y": 120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: b42d7a24-81b0-40c6-887f-a22d1373da10
    type: regular
    task:
      id: b42d7a24-81b0-40c6-887f-a22d1373da10
      version: -1
      name: Generate Investigation Summary Report
      description: |-
        A script to generate an investigation summary report in an automated way
        Can be used in post-processing flow as well.
      scriptName: GenerateInvestigationSummaryReport
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "99"
    scriptarguments:
      incidentId:
        complex:
          root: incident
          accessor: id
      name: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: b7217208-e1a2-408d-8aee-9513ced4fe4b
    type: condition
    task:
      id: b7217208-e1a2-408d-8aee-9513ced4fe4b
      version: -1
      name: Was a file retrieved?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: File
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: EntryID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 790,
          "y": -280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 0e2a9053-3524-4d1c-84ae-9740ce6253ca
    type: regular
    task:
      id: 0e2a9053-3524-4d1c-84ae-9740ce6253ca
      version: -1
      name: Retrieve file manually
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: 563f2a69-ede9-4377-8c1b-670ab7606f67
    type: regular
    task:
      id: 563f2a69-ede9-4377-8c1b-670ab7606f67
      version: -1
      name: Manual - Hunt for other infected endpoints
      description: Manually hunt for other infected endpoints.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: 3b260fd6-e710-46fd-8c0d-d1bb43f42034
    type: condition
    task:
      id: 3b260fd6-e710-46fd-8c0d-d1bb43f42034
      version: -1
      name: Were there any more infected endpoints found?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "103"
      "Yes":
      - "77"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: 288d8749-0469-4dfc-8716-9f2525c77704
    type: regular
    task:
      id: 288d8749-0469-4dfc-8716-9f2525c77704
      version: -1
      name: Analyst manual remediation
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": 5900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "44":
    id: "44"
    taskid: c3ffcd70-6430-4587-83c4-829071816ab0
    type: regular
    task:
      id: c3ffcd70-6430-4587-83c4-829071816ab0
      version: -1
      name: Perform manual malware analysis and forensics
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "71"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "45":
    id: "45"
    taskid: 21220e7b-dcd9-453c-8760-ec6ad2609160
    type: title
    task:
      id: 21220e7b-dcd9-453c-8760-ec6ad2609160
      version: -1
      name: False Positive
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "74"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "46":
    id: "46"
    taskid: d542dd80-062d-4e32-8d87-221cc6793aba
    type: condition
    task:
      id: d542dd80-062d-4e32-8d87-221cc6793aba
      version: -1
      name: Get analyst approval for local containment
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "98"
      "Yes":
      - "95"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "50":
    id: "50"
    taskid: 8cef4a7e-9abd-4e7a-8747-950ff1363fdd
    type: condition
    task:
      id: 8cef4a7e-9abd-4e7a-8747-950ff1363fdd
      version: -1
      name: Auto-Isolation?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "51"
      "yes":
      - "95"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: inputs.AutoIsolation
                filters:
                - - operator: lessThanOrEqual
                    left:
                      value:
                        simple: inputs.AutoIsolation
                      iscontext: true
                    right:
                      value:
                        simple: incident.severity
                      iscontext: true
            iscontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "51":
    id: "51"
    taskid: 2f8835b8-7cba-44b6-823f-510be08c806b
    type: condition
    task:
      id: 2f8835b8-7cba-44b6-823f-510be08c806b
      version: -1
      name: Continue with the investigation or close as false positive?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      Close as False positive:
      - "45"
      Continue:
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -80,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "52":
    id: "52"
    taskid: 65724e73-0feb-47f5-8d3e-1aef9fb9c907
    type: playbook
    task:
      id: 65724e73-0feb-47f5-8d3e-1aef9fb9c907
      version: -1
      name: Calculate Severity - Generic v2
      description: |-
        Calculate and assign the incident severity based on the highest returned severity level from the following calculations:

        - DBotScores of indicators
        - Critical assets
        - Email authenticity
        - Current incident severity
      playbookName: Calculate Severity - Generic v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      Account:
        complex:
          root: Account
          transformers:
          - operator: uniq
      CriticalEndpoints:
        complex:
          root: inputs.CriticalEndpoints
          transformers:
          - operator: uniq
      CriticalGroups:
        complex:
          root: inputs.CriticalGroups
          transformers:
          - operator: uniq
      CriticalUsers:
        complex:
          root: inputs.CriticalUsers
          transformers:
          - operator: uniq
      DBotScore:
        complex:
          root: DBotScore
      EmailAuthenticityCheck:
        complex:
          root: Email
          accessor: AuthenticityCheck
          transformers:
          - operator: uniq
      Endpoint:
        complex:
          root: incident
          accessor: Hostname
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "55":
    id: "55"
    taskid: fd751354-1d35-44ad-81dd-2ec7ac0b4cdf
    type: regular
    task:
      id: fd751354-1d35-44ad-81dd-2ec7ac0b4cdf
      version: -1
      name: Notify that more infected endpoints were found
      description: Send an email
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: |-
          During an endpoint malware investigation in Demisto, other infected endpoints were found, which can possibly indicate the malware is spreading in your organization and requires your attention.
          To get more information, go to this incident in Demisto: ${incident.id}
      cc: {}
      htmlBody: {}
      replyTo: {}
      subject:
        simple: Potential malware spreading in your organization
      templateParams: {}
      to:
        complex:
          root: inputs.Email
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "56":
    id: "56"
    taskid: fb27ac98-1e3e-4ce6-8c4d-d6d7cb9a5b12
    type: condition
    task:
      id: fb27ac98-1e3e-4ce6-8c4d-d6d7cb9a5b12
      version: -1
      name: Send notification regarding infected endpoints?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "66"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.Email
            iscontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 4710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "57":
    id: "57"
    taskid: af45ad3a-c7df-46a6-8b71-eb7c691a9a94
    type: title
    task:
      id: af45ad3a-c7df-46a6-8b71-eb7c691a9a94
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 7290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "58":
    id: "58"
    taskid: 745f5abb-b87a-4f00-8486-f43045b41744
    type: regular
    task:
      id: 745f5abb-b87a-4f00-8486-f43045b41744
      version: -1
      name: Close Investigation
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id:
        complex:
          root: incident
          accessor: id
      mndadone: {}
      phishingconfirmationstatus: {}
      phishingsubtype: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 7120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "59":
    id: "59"
    taskid: a82031e5-2b56-4734-815a-4ec30ac09b52
    type: regular
    task:
      id: a82031e5-2b56-4734-815a-4ec30ac09b52
      version: -1
      name: Manual - Close incident in the source product
      description: Close the incident in the source product that triggered it.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 6950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: 4e2224f0-7a53-40b6-8d37-85a36e2929a5
    type: regular
    task:
      id: 4e2224f0-7a53-40b6-8d37-85a36e2929a5
      version: -1
      name: Set incident - Isolated field
      description: Change the properties of an incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "98"
    scriptarguments:
      Crowdstrikefamily: {}
      Crowdstrikescore: {}
      account: {}
      accountid: {}
      addLabels: {}
      affecteddata: {}
      affecteddatatype: {}
      affectedindividualscontactinformation: {}
      agentid: {}
      agentversion: {}
      alertid: {}
      alertrules: {}
      alertstatus: {}
      alerttime: {}
      app: {}
      approximatenumberofaffecteddatasubjects: {}
      assetid: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      awsfindingid: {}
      awsfindingtype: {}
      awsinstanceid: {}
      awsinstancename: {}
      bdcontactemail: {}
      bdcontactname: {}
      blockedaction: {}
      bugtraq: {}
      city: {}
      clicktime: {}
      closeNotes: {}
      closeReason: {}
      cluster: {}
      commandline: {}
      companyaddress: {}
      companycity: {}
      companycountry: {}
      companyhasinsuranceforthebreach: {}
      companyname: {}
      companypostalcode: {}
      compliancemetadata: {}
      contactaddress: {}
      contactname: {}
      country: {}
      countrywherebusinesshasitsmainestablishment: {}
      countrywherethebreachtookplace: {}
      criticalassets: {}
      currentip: {}
      customFields: {}
      customidstring: {}
      cve: {}
      cvss: {}
      dataencryptionstatus: {}
      datetimeofthebreach: {}
      deleteEmptyField: {}
      demoautomatedcondition: {}
      demomanualcondition: {}
      description: {}
      dest: {}
      destntdomain: {}
      details: {}
      detectid: {}
      detectname: {}
      detectorid: {}
      detecttime: {}
      devicename: {}
      dpoemailaddress: {}
      duration: {}
      emailaddress: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailrecipient: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      endpointgrid: {}
      eventtype: {}
      executableswritten: {}
      exposedport: {}
      externalip: {}
      falconhostlink: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      findingid: {}
      firstseen: {}
      groupid: {}
      guid: {}
      hadasanothershorttext: {}
      hadasanothertest: {}
      hostname: {}
      id: {}
      indicatorsofinterest: {}
      infected: {}
      infectedhosts: {}
      internalip: {}
      involvedusers: {}
      ioctype: {}
      iocvalue: {}
      isolated:
        simple: Endpoint was isolated successfully.
      isthedatasubjecttodpia: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastseen: {}
      licenseexpirydate: {}
      likelyimpact: {}
      localip: {}
      macaddress: {}
      maliciousbehavior: {}
      maliciouscauseifthecauseisamaliciousattack: {}
      malwarefamily: {}
      malwarescore: {}
      md5string: {}
      measurestomitigate: {}
      messageparts: {}
      messagetime: {}
      mnda: {}
      mndadone: {}
      myhtml: {}
      mymultiselect: {}
      myrequiredtext: {}
      name: {}
      nextsteps: {}
      notes: {}
      objective: {}
      occurred: {}
      offset: {}
      operator: {}
      osname: {}
      ostype: {}
      osversion: {}
      owner: {}
      parantprocessname: {}
      parentprocessid: {}
      parentprocessname: {}
      partnercontacts: {}
      partnerproduct: {}
      patterndispositiondescription: {}
      patterndispositionflags: {}
      patterndispositionvalue: {}
      phase: {}
      phishingconfirmationstatus: {}
      phishingsubtype: {}
      phishscore: {}
      pid: {}
      platform: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyname: {}
      policyrecommendation: {}
      policyremediable: {}
      policyroutes: {}
      policyscanconfigid: {}
      policyseverity: {}
      policytype: {}
      possiblecauseofthebreach: {}
      postalcode: {}
      previousip: {}
      processendtime: {}
      processid: {}
      processname: {}
      processstarttime: {}
      qid: {}
      quarantined: {}
      quarantinefolder: {}
      quarantinerule: {}
      rating: {}
      redlockalertid: {}
      redlockpolicyname: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reportingdepartment: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      sectorofaffectedparty: {}
      securitygroupid: {}
      sensorid: {}
      severity: {}
      severityname: {}
      sha1: {}
      sha256: {}
      signature: {}
      sizenumberofemployees: {}
      sizeturnover: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      solutionbrief: {}
      spamscore: {}
      src: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      systemdefault: {}
      systems: {}
      tactic: {}
      technique: {}
      telephoneno: {}
      terminatedaction: {}
      test: {}
      testfieldhadas: {}
      threatactor: {}
      threatinfomap: {}
      threattime: {}
      ticketnumber: {}
      trapsid: {}
      triggeredsecurityprofile: {}
      type: {}
      user: {}
      useragent: {}
      vendorid: {}
      vendorproduct: {}
      version: {}
      vpcid: {}
      vulnerabilitycategory: {}
      whereisdatahosted: {}
      wildfiresubtype: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhighseverityalerts: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrincidentmarkdown: {}
      xdrlowseverityalertcount: {}
      xdrlowseverityalerts: {}
      xdrmanualseverity: {}
      xdrmediumseverityalertcount: {}
      xdrmediumseverityalerts: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrurl: {}
      xdrusercount: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: 5ced3ed5-4b18-4424-8392-48fa126a1fea
    type: title
    task:
      id: 5ced3ed5-4b18-4424-8392-48fa126a1fea
      version: -1
      name: Isolate infected endpoints
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "104"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: ef0f25b8-1bee-4d96-8998-08ef6fa98727
    type: playbook
    task:
      id: ef0f25b8-1bee-4d96-8998-08ef6fa98727
      version: -1
      name: Retrieve File from Endpoint - Generic V2
      description: |-
        'This playbook retrieves a file sample from an endpoint using the following playbooks:'
        - Get File Sample From Path - Generic v2.
        - Get File Sample By Hash - Generic v3.
      playbookName: Retrieve File from Endpoint - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      Agent_ID:
        simple: ${EndpointDetails.ID}
      Hostname:
        simple: ${EndpointDetails.Hostname}
      MD5:
        simple: ${inputs.MD5}
      Path:
        simple: ${inputs.FilePath}
      SHA256:
        simple: ${inputs.SHA256}
      UseD2:
        simple: ${inputs.UseD2}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 790,
          "y": -435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "68":
    id: "68"
    taskid: 83760aac-4630-466f-811f-c4b02eca45c3
    type: condition
    task:
      id: 83760aac-4630-466f-811f-c4b02eca45c3
      version: -1
      name: Activate automatic hunting
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.ActivateAutomaticHunting
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: 0d4a7167-b17b-4b01-86e5-045619f3ed3a
    type: playbook
    task:
      id: 0d4a7167-b17b-4b01-86e5-045619f3ed3a
      version: -1
      name: 'Threat Hunting - Generic '
      description: "This playbook purpose is to allow threat hunting for IOC's in\
        \ your enterprise.\nThis playbook currently supports the following integrations:\n\
        - Splunk\n- Qradar\n- Pan-os\n- Cortex data lake \n- Autofocus"
      playbookName: 'Threat Hunting - Generic '
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "101"
    scriptarguments:
      Hostname: {}
      IPAddress: {}
      InternalDomainName:
        simple: ${inputs.InternalDomainName}
      InternalHostRegex:
        simple: ${inputs.InternalHostRegex}
      InternalRange:
        simple: ${inputs.InternalRange}
      MD5:
        simple: ${inputs.MD5}
      SHA1:
        simple: D4ABAC114DBE28BAD8855C10D37F2B727177C9CA
      SHA256:
        simple: ${inputs.SHA256}
      URLDomain:
        simple: ${inputs.URLDomain}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "70":
    id: "70"
    taskid: d07fef12-0b92-4959-87d3-43648ac57c8e
    type: condition
    task:
      id: d07fef12-0b92-4959-87d3-43648ac57c8e
      version: -1
      name: Continue to manual threat hunting?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.ManualThreatHunting
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "71":
    id: "71"
    taskid: 549abbea-da01-4862-827e-685e1fdac35a
    type: condition
    task:
      id: 549abbea-da01-4862-827e-685e1fdac35a
      version: -1
      name: Need more forensics?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.NeedMoreForensics
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "73":
    id: "73"
    taskid: 07fc2eec-1d8c-4e2f-8f35-3ad5e146e450
    type: regular
    task:
      id: 07fc2eec-1d8c-4e2f-8f35-3ad5e146e450
      version: -1
      name: Assign incident to analyst
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      scriptName: AssignAnalystToIncident
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "97"
    scriptarguments:
      assignBy: {}
      email: {}
      onCall:
        simple: "true"
      roles: {}
      username: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "74":
    id: "74"
    taskid: 6b1ed7a5-6962-48b4-8321-fab175608efd
    type: regular
    task:
      id: 6b1ed7a5-6962-48b4-8321-fab175608efd
      version: -1
      name: Whitelist the file that Caused the FP in the source product
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 2130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "76":
    id: "76"
    taskid: c714a7c0-82bb-4fda-8de7-05366e63dea1
    type: playbook
    task:
      id: c714a7c0-82bb-4fda-8de7-05366e63dea1
      version: -1
      name: 'Get host forensics - Generic '
      description: "This playbook purpose is to retrieve forensics from hosts.\nThe\
        \ available integration:\n- Illusive networks. "
      playbookName: 'Get host forensics - Generic '
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      end_date: {}
      fqdn_or_ip:
        simple: ${Endpoint.IPAddress}
      start_date: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "77":
    id: "77"
    taskid: 692f1ca6-b28e-4bbf-8799-0b392401d116
    type: regular
    task:
      id: 692f1ca6-b28e-4bbf-8799-0b392401d116
      version: -1
      name: Manually list detected host names
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "78"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "78":
    id: "78"
    taskid: ea42e90d-fec2-4b69-8a13-0077468fb4b3
    type: regular
    task:
      id: ea42e90d-fec2-4b69-8a13-0077468fb4b3
      version: -1
      name: Set manual host names
      description: "Takes the comments of a given entry ID and stores them in the\
        \ incident context, under a provided context key. \nFor accessing the last\
        \ executed task's comments, provide ${lastCompletedTaskEntries.[0]} as the\
        \ value for the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      contextKey:
        simple: Threat.Hunting.Detected.Hostsname
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "79":
    id: "79"
    taskid: a7746804-981e-4c05-8774-0c5f875d1c6c
    type: condition
    task:
      id: a7746804-981e-4c05-8774-0c5f875d1c6c
      version: -1
      name: Activated auto unisolation
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "80"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AutoUnIsolation
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "80":
    id: "80"
    taskid: 25fe6a24-e679-4bb3-8025-a2f95e206c14
    type: playbook
    task:
      id: 25fe6a24-e679-4bb3-8025-a2f95e206c14
      version: -1
      name: Unisolate Endpoint - Generic
      description: "This playbook will auto Unisolate endpoints by the endpoint id\
        \ that was provided in the playbook.\nCurrently supports the next integration:\n\
        - Carbon Black Response\n- Cortex XDR\n- Crowdstrike Falcon\n- FireEye HX\
        \ \n- Cybereason\n"
      playbookName: Unisolate Endpoint - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      Endpoint_ID:
        simple: ${EndpointDetails.ID}
      Hostname:
        complex:
          root: EndpointDetails
          accessor: Hostname
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Threat.Hunting.Detected.Hostsname
      ManualHunting.DetectedHosts:
        simple: ${Threat.Hunting.Detected.Hostsname}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 410,
          "y": 6690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "81":
    id: "81"
    taskid: b14ce329-cc8c-4676-8326-5e8f77e5306a
    type: playbook
    task:
      id: b14ce329-cc8c-4676-8326-5e8f77e5306a
      version: -1
      name: Get endpoint details - Generic
      description: 'This playbook use the generic command !endpoint to retrieve details
        on specific endpoint. '
      playbookName: Get endpoint details - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "82"
      - "88"
      - "85"
    scriptarguments:
      Endpoint_hostname:
        simple: ${inputs.Hostname}
      Endpoint_id:
        simple: ${inputs.Agent_ID}
      Endpoint_ip:
        simple: ${inputs.Endpoint_ip}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 480,
          "y": -2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "82":
    id: "82"
    taskid: b3c4469e-1458-4ca1-8db6-99bc7fb514eb
    type: title
    task:
      id: b3c4469e-1458-4ca1-8db6-99bc7fb514eb
      version: -1
      name: ID
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "83"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": -2260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "83":
    id: "83"
    taskid: 11ff1734-b71c-49d2-8a01-080ee91a2d27
    type: condition
    task:
      id: 11ff1734-b71c-49d2-8a01-080ee91a2d27
      version: -1
      name: Is the endpoint details was retrieved by ID?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "91"
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: ${Endpoint.ID}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": -2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "84":
    id: "84"
    taskid: 28d2c66f-b666-46b2-8178-d9e852d05511
    type: regular
    task:
      id: 28d2c66f-b666-46b2-8178-d9e852d05511
      version: -1
      name: Set endpoint id to context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Endpoint.ID
      stringify: {}
      value:
        simple: ${inputs.Agent_ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 970,
          "y": -1760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "85":
    id: "85"
    taskid: b98d77fc-0df4-441f-8cac-28b3301b8911
    type: title
    task:
      id: b98d77fc-0df4-441f-8cac-28b3301b8911
      version: -1
      name: Hostname
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "86"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1600,
          "y": -2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "86":
    id: "86"
    taskid: f7dfd390-c908-425c-8344-c2ce2f2c1a16
    type: condition
    task:
      id: f7dfd390-c908-425c-8344-c2ce2f2c1a16
      version: -1
      name: 'Is the endpoint details was retrieved by hostname? '
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "92"
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: ${Endpoint.Hostname}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1600,
          "y": -2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "87":
    id: "87"
    taskid: 72c791fe-caad-43b6-8cf0-8f4961ef5395
    type: regular
    task:
      id: 72c791fe-caad-43b6-8cf0-8f4961ef5395
      version: -1
      name: Set endpoint hostname to context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Endpoint.Hostname
      stringify: {}
      value:
        simple: ${inputs.Hostname}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2060,
          "y": -1760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "88":
    id: "88"
    taskid: 0a904b0a-4972-47a1-8819-dcda8af905dc
    type: title
    task:
      id: 0a904b0a-4972-47a1-8819-dcda8af905dc
      version: -1
      name: IP
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "89"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -800,
          "y": -2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "89":
    id: "89"
    taskid: 745b3a03-fd1a-47bc-80fb-ec7a4141e858
    type: condition
    task:
      id: 745b3a03-fd1a-47bc-80fb-ec7a4141e858
      version: -1
      name: Is the endpoint details was retrieved by IP?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: ${Endpoint.IPAddress}
            iscontext: true
    view: |-
      {
        "position": {
          "x": -800,
          "y": -2110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "90":
    id: "90"
    taskid: ae675694-1e00-4509-84ba-a98a6d9f06dd
    type: regular
    task:
      id: ae675694-1e00-4509-84ba-a98a6d9f06dd
      version: -1
      name: Set endpoint IP to context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Endpoint.IPAddress
      stringify: {}
      value:
        simple: ${inputs.Endpoint_ip}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -20,
          "y": -1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "91":
    id: "91"
    taskid: 594c00ba-eaf1-4355-8b43-3ffa404bd483
    type: condition
    task:
      id: 594c00ba-eaf1-4355-8b43-3ffa404bd483
      version: -1
      name: Is agent ID was provided?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "84"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.Agent_ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 740,
          "y": -1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "92":
    id: "92"
    taskid: 79c3a765-b3b9-439b-8fab-61cae4d4bf28
    type: condition
    task:
      id: 79c3a765-b3b9-439b-8fab-61cae4d4bf28
      version: -1
      name: Was hostname provided?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "87"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.Hostname
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1850,
          "y": -1940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "93":
    id: "93"
    taskid: 38577070-8da2-40d9-8432-a8499ad79add
    type: condition
    task:
      id: 38577070-8da2-40d9-8432-a8499ad79add
      version: -1
      name: Was endpoint IP provided?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "90"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.Endpoint_ip
            iscontext: true
    view: |-
      {
        "position": {
          "x": -420,
          "y": -1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "94":
    id: "94"
    taskid: dda63531-7639-48fe-834b-9333a84fd020
    type: playbook
    task:
      id: dda63531-7639-48fe-834b-9333a84fd020
      version: -1
      name: Isolate Endpoint - Generic V2
      description: |-
        This playbook isolates a given endpoint via various of endpoints products integration.
        Make sure to provide the valid playbook input for the integration that you using.
      playbookName: Isolate Endpoint - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      Endpoint_hostname:
        simple: ${EndpointDetails.Hostname}
      Endpoint_id:
        simple: ${EndpointDetails.ID}
      Endpoint_ip:
        simple: ${Endpoint.IPAddress}
      ManualHunting.DetectedHosts:
        simple: ${ManualHunting.DetectedHosts}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "95":
    id: "95"
    taskid: 3c934c9b-bb04-455d-8dcf-1c794df45a9b
    type: playbook
    task:
      id: 3c934c9b-bb04-455d-8dcf-1c794df45a9b
      version: -1
      name: Isolate Endpoint - Generic V2
      description: |-
        This playbook isolates a given endpoint via various of endpoints products integration.
        Make sure to provide the valid playbook input for the integration that you using.
      playbookName: Isolate Endpoint - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      Endpoint_hostname:
        simple: ${EndpointDetails.Hostname}
      Endpoint_id:
        simple: ${EndpointDetails.ID}
      Endpoint_ip:
        simple: ${EndpointDetails.IPAddress}
      ManualHunting.DetectedHosts:
        simple: ${ManualHunting.DetectedHosts}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "97":
    id: "97"
    taskid: 65195858-cda7-49a5-8a03-adce259b700c
    type: title
    task:
      id: 65195858-cda7-49a5-8a03-adce259b700c
      version: -1
      name: Isolation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "98":
    id: "98"
    taskid: 9f4826e1-bb1e-4281-8f05-bc4cf3c0b544
    type: title
    task:
      id: 9f4826e1-bb1e-4281-8f05-bc4cf3c0b544
      version: -1
      name: Forensics
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "99":
    id: "99"
    taskid: a9632b1b-ba2d-4160-85a3-635c6dc030f9
    type: title
    task:
      id: a9632b1b-ba2d-4160-85a3-635c6dc030f9
      version: -1
      name: Unisolation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "100":
    id: "100"
    taskid: f6049943-64f7-4ed7-8ecc-1482f2665271
    type: regular
    task:
      id: f6049943-64f7-4ed7-8ecc-1482f2665271
      version: -1
      name: Set user as account
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      append: {}
      key:
        simple: Account.Username
      stringify: {}
      value:
        complex:
          root: incident
          accessor: user
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "101":
    id: "101"
    taskid: 2d77ac1d-d24e-47ad-8ebf-22f368e423ec
    type: regular
    task:
      id: 2d77ac1d-d24e-47ad-8ebf-22f368e423ec
      version: -1
      name: Set detected hostnames to context
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "102"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Hostsname
      stringify: {}
      value:
        complex:
          root: QRadar
          accessor: DetectedInternalHosts
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: PANWHunting.DetectedInternalHosts
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: Splunk.DetectedInternalHosts
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "102":
    id: "102"
    taskid: d728473e-c8d6-4808-8a57-4d3676ff0904
    type: regular
    task:
      id: d728473e-c8d6-4808-8a57-4d3676ff0904
      version: -1
      name: Set detected IP's to context
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "105"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.IP
      stringify: {}
      value:
        complex:
          root: Splunk
          accessor: DetectedInternalIPs
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: PANWHunting.DetectedInternalIPs
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: QRadar.DetectedInternalIPs
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "103":
    id: "103"
    taskid: c6f1bd08-d81a-4222-860e-cb714022a44b
    type: title
    task:
      id: c6f1bd08-d81a-4222-860e-cb714022a44b
      version: -1
      name: No results for manual TH
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -90,
          "y": 5070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "104":
    id: "104"
    taskid: 42b441ba-6091-4dcf-8158-38798770c118
    type: playbook
    task:
      id: 42b441ba-6091-4dcf-8158-38798770c118
      version: -1
      name: Get endpoint details - Generic
      description: 'This playbook use the generic command !endpoint to retrieve details
        on specific endpoint. '
      playbookName: Get endpoint details - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "94"
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${EndpointDetails.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "105":
    id: "105"
    taskid: ab260a89-1739-4459-8b54-971263185e4a
    type: regular
    task:
      id: ab260a89-1739-4459-8b54-971263185e4a
      version: -1
      name: Set threat hunting results to layout
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      accountid: {}
      accountinformationbreached: {}
      accountname: {}
      addLabels: {}
      affecteddata: {}
      affecteddatatype: {}
      affectedindividualscontactinformation: {}
      agentid: {}
      agentsids: {}
      alertid: {}
      alertname: {}
      app: {}
      appchannelname: {}
      appendMultiSelect: {}
      appendTags: {}
      applicationid: {}
      applicationname: {}
      appmessage: {}
      approximatenumberofaffecteddatasubjects: {}
      assetid: {}
      assettable: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      attorneygeneralnotification: {}
      behaviourobjective: {}
      behaviourscenario: {}
      behaviourtactic: {}
      blockedaction: {}
      breachconfirmation: {}
      bugtraq: {}
      caller: {}
      categorycount: {}
      childprocess: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      closetime: {}
      closingreason: {}
      closinguser: {}
      cloudservice: {}
      cmd: {}
      commandline: {}
      companyaddress: {}
      companycity: {}
      companycountry: {}
      companyhasinsuranceforthebreach: {}
      companyname: {}
      companypostalcode: {}
      compliancenotes: {}
      consumerreportingagenciesnotification: {}
      contactaddress: {}
      contactemailaddress: {}
      contactname: {}
      contacttelephonenumber: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      countrywherebusinesshasitsmainestablishment: {}
      countrywherethebreachtookplace: {}
      credibilityoffense: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      cvssavailabilityrequirement: {}
      cvsscollateraldamagepotential: {}
      cvssconfidentialityrequirement: {}
      cvssintegrityrequirement: {}
      dataencryptionstatus: {}
      datetimeofthebreach: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      description: {}
      descriptionasset: {}
      descriptionoffense: {}
      dest: {}
      desthostname: {}
      destinationgeolocation: {}
      destinationhostname: {}
      destinationip: {}
      destinationipoffense: {}
      destinationips: {}
      destinationipv6: {}
      destinationmacaddress: {}
      destinationnetwork: {}
      destinationnetworkoffense: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedips:
        complex:
          root: Threat.Hunting.Detected
          accessor: IP
      detecteduser:
        complex:
          root: Splunk
          accessor: DetectedUsers
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: PANWHunting.DetectedUsers
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: QRadar.DetectedUsers
                iscontext: true
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      deviceid: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      devicetime: {}
      displayname: {}
      dnsname: {}
      domainoffense: {}
      dpoemailaddress: {}
      dponotification: {}
      dstports: {}
      duration: {}
      email: {}
      emailaddress: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailhtmlimage: {}
      emailinreplyto: {}
      emailkeywords: {}
      emaillabels: {}
      emaillatestmessage: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      endpoint: {}
      endpointhostname: {}
      endpointid: {}
      endpointids: {}
      endpointip: {}
      endpointisisolated: {}
      endpointmacaddress: {}
      endpointos: {}
      endpointvendor: {}
      errorcode: {}
      errormessage: {}
      escalation: {}
      eventaction: {}
      eventdescriptions: {}
      eventid: {}
      eventnames: {}
      events: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filemd5: {}
      filename: {}
      filenames: {}
      filepath: {}
      filepaths: {}
      filesha1: {}
      filesha256: {}
      filesize: {}
      financialinformationbreached: {}
      firstname: {}
      firstseen: {}
      followup: {}
      givenname: {}
      healthinsurancebreached: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      highlevelcategories: {}
      hostname: {}
      hostnames:
        complex:
          root: Threat.Hunting.Detected
          accessor: Hostsname
      id: {}
      idasset: {}
      idoffense: {}
      illusivenetworksdeceptionfamilies: {}
      illusivenetworkseventsnumber: {}
      illusivenetworkshasforensics: {}
      illusivenetworkshostname: {}
      illusivenetworksid: {}
      illusivenetworkslastseenuser: {}
      illusivenetworkssourceoperatingsystem: {}
      illusivenetworksstepstocrownjewel: {}
      illusivenetworksstepstodomainadmin: {}
      incidentlink: {}
      incomingmirrorerror: {}
      individualsnotification: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      ipaddressasset: {}
      isolated: {}
      isthedatasubjecttodpia: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmirroredintime: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      lastupdatetime: {}
      leadership: {}
      likelyimpact: {}
      linktooffense: {}
      listofrulesevent: {}
      listofrulesoffense: {}
      location: {}
      locationasset: {}
      locationregion: {}
      logsource: {}
      logsourcename: {}
      logsourcetype: {}
      lowlevelcategoriesevents: {}
      lowlevelcategoriesoffense: {}
      macaddress: {}
      macaddressasset: {}
      magnitudeoffense: {}
      maliciousbehavior: {}
      maliciouscauseifthecauseisamaliciousattack: {}
      malwarefamily: {}
      malwarename: {}
      managementnotification: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      measurestomitigate: {}
      medianotification: {}
      medicalinformationbreached: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      numberofeventsinoffense: {}
      numberoffetchedevents: {}
      numberofflows: {}
      numberoflogsources: {}
      objective: {}
      occurred: {}
      offenseinactive: {}
      os: {}
      osversion: {}
      otherpiidatabreached: {}
      outgoingmirrorerror: {}
      outofftheoffice: {}
      owner: {}
      parentprocess: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      piidatatype: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      possiblecauseofthebreach: {}
      postalcode: {}
      postnatdestinationip: {}
      postnatdestinationport: {}
      postnatsourceip: {}
      postnatsourceport: {}
      prenatdestinationport: {}
      prenatsourceip: {}
      prenatsourceport: {}
      protocol: {}
      protocolevent: {}
      protocols: {}
      quarantined: {}
      rating: {}
      rawevent: {}
      region: {}
      regionid: {}
      relatedincidents: {}
      relevanceoffense: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      residentnotificationoption: {}
      residentsemailaddress: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rulename: {}
      samaccountname: {}
      scenario: {}
      secretarynotification: {}
      sectorofaffectedparty: {}
      servicenowassignedto: {}
      servicenowassignmentgroup: {}
      servicenowcaller: {}
      servicenowcallerid: {}
      servicenowcategory: {}
      servicenowclosedby: {}
      servicenowcloseddate: {}
      servicenowdescription: {}
      servicenowduedate: {}
      servicenowescalation: {}
      servicenowimpact: {}
      servicenownotify: {}
      servicenowopeneddate: {}
      servicenowpriority: {}
      servicenowresolutioncode: {}
      servicenowresolutionnotes: {}
      servicenowresolvedtime: {}
      servicenowseverity: {}
      servicenowstate: {}
      servicenowticketnumber: {}
      servicenowurgency: {}
      severity: {}
      severityoffense: {}
      sha1: {}
      sha256: {}
      sha512: {}
      shiftmanagerbriefing: {}
      shiftopenincidents: {}
      signature: {}
      similarincidents: {}
      sizenumberofemployees: {}
      sizeturnover: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcegeolocation: {}
      sourcehostname: {}
      sourceip: {}
      sourceipoffense: {}
      sourceips: {}
      sourceipv6: {}
      sourcemacaddress: {}
      sourcenetwork: {}
      sourcenetworkoffense: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcports: {}
      srcuser: {}
      starttime: {}
      state: {}
      statecisonotification: {}
      statewherethebreachtookplace: {}
      statusoffense: {}
      streetaddress: {}
      subcategory: {}
      subtype: {}
      surname: {}
      switchidasset: {}
      switchportidasset: {}
      systems: {}
      tactic: {}
      tacticid: {}
      tags: {}
      teamname: {}
      technicalowner: {}
      technicalownercontact: {}
      technicaluser: {}
      technique: {}
      techniqueid: {}
      telephoneno: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      threathuntingdetectedhostnames: {}
      threathuntingdetectedip: {}
      ticketacknowledgeddate: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      timezone: {}
      title: {}
      tojointhemeeting: {}
      tostartthemeeting: {}
      trafficdirection: {}
      trapsid: {}
      triggeredsecurityprofile: {}
      type: {}
      typeoffense: {}
      uniquebiometricdatabreached: {}
      uniqueidentificationnumberbreached: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      userid: {}
      username: {}
      usernamecountoffense: {}
      usernames: {}
      users: {}
      vendorid: {}
      vendorproduct: {}
      vulnerabilitycategory: {}
      whereisdatahosted: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrdevicecontrolviolations: {}
      xdrdisconnectedendpoints: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmanualseverity: {}
      xdrmediumseverityalertcount: {}
      xdrmodificationtime: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      xsoarReadOnlyRoles: {}
      zipcode: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "106":
    id: "106"
    taskid: e1070d44-31ae-49ca-8bae-26359374eba5
    type: regular
    task:
      id: e1070d44-31ae-49ca-8bae-26359374eba5
      version: -1
      name: 'Set file and endpoint details to layout '
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "6"
      - "5"
    scriptarguments:
      accountid: {}
      accountinformationbreached: {}
      accountname: {}
      addLabels: {}
      affecteddata: {}
      affecteddatatype: {}
      affectedindividualscontactinformation: {}
      agentid: {}
      agentsids: {}
      alertid: {}
      alertname: {}
      app: {}
      appchannelname: {}
      appendMultiSelect: {}
      appendTags: {}
      applicationid: {}
      applicationname: {}
      appmessage: {}
      approximatenumberofaffecteddatasubjects: {}
      assetid: {}
      assettable: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      attorneygeneralnotification: {}
      behaviourobjective: {}
      behaviourscenario: {}
      behaviourtactic: {}
      blockedaction: {}
      breachconfirmation: {}
      bugtraq: {}
      caller: {}
      categorycount: {}
      childprocess: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      closetime: {}
      closingreason: {}
      closinguser: {}
      cloudservice: {}
      cmd:
        complex:
          root: incident
          accessor: commandline
      commandline: {}
      companyaddress: {}
      companycity: {}
      companycountry: {}
      companyhasinsuranceforthebreach: {}
      companyname: {}
      companypostalcode: {}
      compliancenotes: {}
      consumerreportingagenciesnotification: {}
      contactaddress: {}
      contactemailaddress: {}
      contactname: {}
      contacttelephonenumber: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      countrywherebusinesshasitsmainestablishment: {}
      countrywherethebreachtookplace: {}
      credibilityoffense: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      cvssavailabilityrequirement: {}
      cvsscollateraldamagepotential: {}
      cvssconfidentialityrequirement: {}
      cvssintegrityrequirement: {}
      dataencryptionstatus: {}
      datetimeofthebreach: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      description: {}
      descriptionasset: {}
      descriptionoffense: {}
      dest: {}
      desthostname: {}
      destinationgeolocation: {}
      destinationhostname: {}
      destinationip: {}
      destinationipoffense: {}
      destinationips: {}
      destinationipv6: {}
      destinationmacaddress: {}
      destinationnetwork: {}
      destinationnetworkoffense: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      deviceid: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      devicetime: {}
      displayname: {}
      dnsname: {}
      domainoffense: {}
      dpoemailaddress: {}
      dponotification: {}
      dstports: {}
      duration: {}
      email: {}
      emailaddress: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailhtmlimage: {}
      emailinreplyto: {}
      emailkeywords: {}
      emaillabels: {}
      emaillatestmessage: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      endpoint: {}
      endpointhostname:
        complex:
          root: Endpoint
          accessor: Hostname
      endpointid:
        complex:
          root: Endpoint
          accessor: ID
      endpointids:
        complex:
          root: CrowdStrike.Device
          accessor: ID
      endpointip:
        complex:
          root: Endpoint
          accessor: IPAddress
      endpointisisolated:
        complex:
          root: Endpoint
          accessor: IsIsolated
      endpointmacaddress:
        complex:
          root: Endpoint
          accessor: MACAddress
      endpointos:
        complex:
          root: Endpoint
          accessor: OS
      endpointvendor:
        complex:
          root: Endpoint
          accessor: Vendor
      errorcode: {}
      errormessage: {}
      escalation: {}
      eventaction: {}
      eventdescriptions: {}
      eventid: {}
      eventnames: {}
      events: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filemd5:
        complex:
          root: incident
          accessor: md5
      filename: {}
      filenames:
        complex:
          root: incident
          accessor: filename
      filepath: {}
      filepaths:
        complex:
          root: incident
          accessor: filepath
      filesha1: {}
      filesha256:
        complex:
          root: incident
          accessor: sha256
      filesize: {}
      financialinformationbreached: {}
      firstname: {}
      firstseen: {}
      followup: {}
      givenname: {}
      healthinsurancebreached: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      highlevelcategories: {}
      hostname: {}
      hostnames: {}
      id: {}
      idasset: {}
      idoffense: {}
      illusivenetworksdeceptionfamilies: {}
      illusivenetworkseventsnumber: {}
      illusivenetworkshasforensics: {}
      illusivenetworkshostname: {}
      illusivenetworksid: {}
      illusivenetworkslastseenuser: {}
      illusivenetworkssourceoperatingsystem: {}
      illusivenetworksstepstocrownjewel: {}
      illusivenetworksstepstodomainadmin: {}
      incidentlink: {}
      incomingmirrorerror: {}
      individualsnotification: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      ipaddressasset: {}
      isolated: {}
      isthedatasubjecttodpia: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmirroredintime: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      lastupdatetime: {}
      leadership: {}
      likelyimpact: {}
      linktooffense: {}
      listofrulesevent: {}
      listofrulesoffense: {}
      location: {}
      locationasset: {}
      locationregion: {}
      logsource: {}
      logsourcename: {}
      logsourcetype: {}
      lowlevelcategoriesevents: {}
      lowlevelcategoriesoffense: {}
      macaddress: {}
      macaddressasset: {}
      magnitudeoffense: {}
      maliciousbehavior: {}
      maliciouscauseifthecauseisamaliciousattack: {}
      malwarefamily: {}
      malwarename: {}
      managementnotification: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      measurestomitigate: {}
      medianotification: {}
      medicalinformationbreached: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      numberofeventsinoffense: {}
      numberoffetchedevents: {}
      numberofflows: {}
      numberoflogsources: {}
      objective: {}
      occurred: {}
      offenseinactive: {}
      os: {}
      osversion: {}
      otherpiidatabreached: {}
      outgoingmirrorerror: {}
      outofftheoffice: {}
      owner: {}
      parentprocess: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      piidatatype: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      possiblecauseofthebreach: {}
      postalcode: {}
      postnatdestinationip: {}
      postnatdestinationport: {}
      postnatsourceip: {}
      postnatsourceport: {}
      prenatdestinationport: {}
      prenatsourceip: {}
      prenatsourceport: {}
      protocol: {}
      protocolevent: {}
      protocols: {}
      quarantined: {}
      rating: {}
      rawevent: {}
      region: {}
      regionid: {}
      relatedincidents: {}
      relevanceoffense: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      residentnotificationoption: {}
      residentsemailaddress: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rulename: {}
      samaccountname: {}
      scenario: {}
      secretarynotification: {}
      sectorofaffectedparty: {}
      servicenowassignedto: {}
      servicenowassignmentgroup: {}
      servicenowcaller: {}
      servicenowcallerid: {}
      servicenowcategory: {}
      servicenowclosedby: {}
      servicenowcloseddate: {}
      servicenowdescription: {}
      servicenowduedate: {}
      servicenowescalation: {}
      servicenowimpact: {}
      servicenownotify: {}
      servicenowopeneddate: {}
      servicenowpriority: {}
      servicenowresolutioncode: {}
      servicenowresolutionnotes: {}
      servicenowresolvedtime: {}
      servicenowseverity: {}
      servicenowstate: {}
      servicenowticketnumber: {}
      servicenowurgency: {}
      severity: {}
      severityoffense: {}
      sha1: {}
      sha256: {}
      sha512: {}
      shiftmanagerbriefing: {}
      shiftopenincidents: {}
      signature: {}
      similarincidents: {}
      sizenumberofemployees: {}
      sizeturnover: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcegeolocation: {}
      sourcehostname: {}
      sourceip: {}
      sourceipoffense: {}
      sourceips: {}
      sourceipv6: {}
      sourcemacaddress: {}
      sourcenetwork: {}
      sourcenetworkoffense: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcports: {}
      srcuser: {}
      starttime: {}
      state: {}
      statecisonotification: {}
      statewherethebreachtookplace: {}
      statusoffense: {}
      streetaddress: {}
      subcategory: {}
      subtype: {}
      surname: {}
      switchidasset: {}
      switchportidasset: {}
      systems: {}
      tactic: {}
      tacticid: {}
      tags: {}
      teamname: {}
      technicalowner: {}
      technicalownercontact: {}
      technicaluser: {}
      technique: {}
      techniqueid: {}
      telephoneno: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      threathuntingdetectedhostnames: {}
      threathuntingdetectedip: {}
      ticketacknowledgeddate: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      timezone: {}
      title: {}
      tojointhemeeting: {}
      tostartthemeeting: {}
      trafficdirection: {}
      trapsid: {}
      triggeredsecurityprofile: {}
      type: {}
      typeoffense: {}
      uniquebiometricdatabreached: {}
      uniqueidentificationnumberbreached: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      userid: {}
      username: {}
      usernamecountoffense: {}
      usernames: {}
      users:
        complex:
          root: incident
          accessor: user
      vendorid: {}
      vendorproduct: {}
      vulnerabilitycategory: {}
      whereisdatahosted: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrdevicecontrolviolations: {}
      xdrdisconnectedendpoints: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmanualseverity: {}
      xdrmediumseverityalertcount: {}
      xdrmodificationtime: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      xsoarReadOnlyRoles: {}
      zipcode: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1040,
          "y": -770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "107":
    id: "107"
    taskid: 76413e7b-f6f2-4591-8f3d-22520585330a
    type: regular
    task:
      id: 76413e7b-f6f2-4591-8f3d-22520585330a
      version: -1
      name: Set grid
      description: Creates a Grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "106"
    scriptarguments:
      columns:
        simple: Endpoint Hostname,Endpoint ID,Endpoint IP Address,Endpoint Is Isolated,Endpoint
          MAC Address,Endpoint OS,Endpoint Vendor
      context_path:
        simple: EndpointDetails
      grid_id:
        simple: endpoint
      keys:
        simple: Hostname,ID,IPAddress,IsIsolated,MACAddress,OS,Vendor
      overwrite: {}
      sort_by: {}
      unpack_nested_elements: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1040,
          "y": -920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "108":
    id: "108"
    taskid: eb534d9c-57fb-4213-8563-6b86ccd61767
    type: condition
    task:
      id: eb534d9c-57fb-4213-8563-6b86ccd61767
      version: -1
      name: 'Is the endpoint details were retrieved? '
      description: Set a value in context under the key you entered.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "6"
      - "5"
      "yes":
      - "110"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Endpoint
                filters:
                - - operator: isNotEmpty
                    left:
                      value:
                        simple: Endpoint
                      iscontext: true
            iscontext: true
    view: |-
      {
        "position": {
          "x": 490,
          "y": -1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "109":
    id: "109"
    taskid: 3e014814-daa1-4eea-8848-df20ca862a6d
    type: regular
    task:
      id: 3e014814-daa1-4eea-8848-df20ca862a6d
      version: -1
      name: 'Set Endpoint Enrichment '
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "107"
    scriptarguments:
      append: {}
      key:
        simple: EndpointDetails
      stringify: {}
      value:
        complex:
          root: Endpoint
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: Endpoint
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1040,
          "y": -1080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "110":
    id: "110"
    taskid: 3f059079-d592-4c3a-8b4c-98e426a69af4
    type: title
    task:
      id: 3f059079-d592-4c3a-8b4c-98e426a69af4
      version: -1
      name: Set to layout
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "109"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1040,
          "y": -1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "111":
    id: "111"
    taskid: 8fe48c4a-572d-4264-8301-7017bc71f22a
    type: regular
    task:
      id: 8fe48c4a-572d-4264-8301-7017bc71f22a
      version: -1
      name: 'Find similar incidents '
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators similarity.
      scriptName: DBotFindSimilarIncidents
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "112"
    scriptarguments:
      aggreagateIncidentsDifferentDate: {}
      fieldExactMatch:
        simple: incident.type
      fieldsToDisplay: {}
      fromDate: {}
      incidentId: {}
      includeIndicatorsSimilarity: {}
      indicatorsTypes: {}
      limit: {}
      maxIncidentsInIndicatorsForWhiteList: {}
      maxIncidentsToDisplay: {}
      minNumberOfIndicators: {}
      minimunIncidentSimilarity: {}
      query: {}
      showCurrentIncident: {}
      showIncidentSimilarityForAllFields: {}
      similarCategoricalField: {}
      similarJsonField: {}
      similarTextField:
        simple: incident.parentcmdline,incident.filepath,incident.commandline
      toDate: {}
      useAllFields: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": -2945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "112":
    id: "112"
    taskid: 3460e959-89df-4a27-8adc-5d36cad86f66
    type: regular
    task:
      id: 3460e959-89df-4a27-8adc-5d36cad86f66
      version: -1
      name: 'Set similar incidents to layout '
      description: Creates a Grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "114"
    scriptarguments:
      columns:
        simple: Incident Id,Created,Name,Similarity Incident,Parent CMD line,File
          path,Command line
      context_path:
        simple: DBotFindSimilarIncidents.similarIncident
      grid_id:
        simple: similarincidentsml
      keys:
        simple: id,created,name,similarity incident,parentcmdline,filepath,commandline
      overwrite: {}
      sort_by: {}
      unpack_nested_elements: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": -2775
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "113":
    id: "113"
    taskid: c4cd9f90-4c84-4dc5-8ea5-721f7e89809d
    type: title
    task:
      id: c4cd9f90-4c84-4dc5-8ea5-721f7e89809d
      version: -1
      name: Find similar incidents
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "111"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": -3105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "114":
    id: "114"
    taskid: 0324ff91-6553-42ec-8f3d-e0b790194083
    type: title
    task:
      id: 0324ff91-6553-42ec-8f3d-e0b790194083
      version: -1
      name: Get endpoint details
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": -2600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "115":
    id: "115"
    taskid: a5c5fd94-46b0-4ed0-8c31-4d57ac1c5bcb
    type: playbook
    task:
      id: a5c5fd94-46b0-4ed0-8c31-4d57ac1c5bcb
      version: -1
      name: Block Indicators - Generic v2
      playbookName: Block Indicators - Generic v2
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": -90,
          "y": 5900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "19_115_Yes": 0.53,
      "19_41_No": 0.58,
      "36_28_yes": 0.49,
      "36_37_#default#": 0.64,
      "39_77_Yes": 0.49,
      "46_98_No": 0.51,
      "50_51_#default#": 0.64,
      "50_95_yes": 0.62,
      "51_45_Close as False positive": 0.51,
      "51_46_Continue": 0.52,
      "56_55_yes": 0.6,
      "71_12_#default#": 0.51,
      "79_21_#default#": 0.64,
      "83_26_yes": 0.52,
      "89_26_yes": 0.22,
      "91_26_#default#": 0.46,
      "92_26_#default#": 0.37
    },
    "paper": {
      "dimensions": {
        "height": 10615,
        "width": 3240,
        "x": -800,
        "y": -3260
      }
    }
  }
inputs:
- key: AutoIsolation
  value:
    simple: "3"
  required: false
  description: |-
    This input determines the threshold severity from which to perform auto-isolation for the infected endpoint.
    Specify the severity number (default is High):
    Specify the severity number:
    0 - Unknown
    0.5 - Informational
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  playbookInputQuery:
- key: Email
  value: {}
  required: false
  description: The Email address to notify if there is a possibility of the malware
    spreading and infecting other endpoints.
  playbookInputQuery:
- key: MD5
  value:
    complex:
      root: incident
      accessor: md5
  required: false
  description: The MD5 hash value for the suspicious file.
  playbookInputQuery:
- key: SHA256
  value:
    complex:
      root: incident
      accessor: sha256
  required: false
  description: The SHA256  hash value for the suspicious file.
  playbookInputQuery:
- key: Hostname
  value:
    complex:
      root: incident
      accessor: hostname
  required: false
  description: Hostname of the machine on which the file is located.
  playbookInputQuery:
- key: FilePath
  value:
    complex:
      root: File
      accessor: Path
  required: false
  description: |-
    The path of the file to retrieve.
    For example:
    C:\users\folder\file.txt
  playbookInputQuery:
- key: UseD2
  value:
    simple: "no"
  required: false
  description: Specifies whether to use D2 agent to retrieve the file.
  playbookInputQuery:
- key: SHA1
  value:
    complex:
      root: incident
      accessor: sha1
  required: false
  description: The SHA1 hash value for the suspicious file.
  playbookInputQuery:
- key: ActivateAutomaticHunting
  value:
    simple: "Yes"
  required: false
  description: |
    Activate Threat Hunting - Generic playbook for automatic hunting.
    Yes- to activate
  playbookInputQuery:
- key: ManualThreatHunting
  value: {}
  required: false
  description: |
    Preform manual threat hunting.
    Yes- to activate
  playbookInputQuery:
- key: NeedMoreForensics
  value:
    simple: "no"
  required: false
  description: "By providing the value `Yes` will activate the playbook `Forensics\
    \ - Generic` that retrieves additional forensics on the investigating host. \n\
    Yes- to activate"
  playbookInputQuery:
- key: IPAddress
  value: {}
  required: false
  description: "This input relevant if the  playbook Threat Hunting - Generic playbook\
    \ is activated. \nIf you activated Threat Hunting - Generic playbook and you are\
    \ hunting IP addresses  please provide them here.\n"
  playbookInputQuery:
- key: URLDomain
  value: {}
  required: false
  description: "This input relevant if the  playbook Threat Hunting - Generic playbook\
    \ is activated. \nIf you activated Threat Hunting - Generic playbook and you are\
    \ hunting for URL or domain please provide them here. "
  playbookInputQuery:
- key: InternalRange
  value: {}
  required: false
  description: "This input relevant if the  playbook Threat Hunting - Generic playbook\
    \ is activated. \nA list of internal IP ranges to check IP addresses against.\
    \ The list should be provided in CIDR notation, separated by commas. An example\
    \ of a list of ranges would be: \"172.16.0.0/12,10.0.0.0/8,192.168.0.0/16\" (without\
    \ quotes). If a list is not provided, will use default list provided in the IsIPInRanges\
    \ script (the known IPv4 private address ranges)."
  playbookInputQuery:
- key: InternalDomainName
  value: {}
  required: false
  description: "This input relevant if the  playbook Threat Hunting - Generic playbook\
    \ is activated. \nThe organizations internal domain name. This is provided for\
    \ the script IsInternalHostName that checks if the detected host names are internal\
    \ or external if the hosts contain the internal domains suffix. For example demisto.com.\
    \ If there is more than one domain, use the | character to separate values such\
    \ as (demisto.com|test.com)"
  playbookInputQuery:
- key: InternalHostRegex
  value: {}
  required: false
  description: |-
    This input relevant if the  playbook Threat Hunting - Generic playbook is activated.
    This is provided for the script IsInternalHostName that checks if the detected host names are internal or external. if the hosts match the organizations naming convention. For example the host testpc1 will have the following regex \w{6}\d{1}
  playbookInputQuery:
- key: Agent_ID
  value:
    complex:
      root: Agents ID
  required: false
  description: 'This input relevant if retrieving file by EDR, if so please provide
    the relevant Agent_ID\Endpoint id.  '
  playbookInputQuery:
- key: CriticalUsers
  value: {}
  required: false
  description: |-
    This input will use for `Calculate Severity - Generic v2` playbook.
    provide here your Critical Users (CSV is optional).
  playbookInputQuery:
- key: CriticalEndpoints
  value: {}
  required: false
  description: |-
    This input will use for `Calculate Severity - Generic v2` playbook.
    provide here your Critical endpoints hostnames (CSV is optional).
  playbookInputQuery:
- key: CriticalGroups
  value: {}
  required: false
  description: |-
    This input will use for `Calculate Severity - Generic v2` playbook.
    provide here the DN names of your critical AD groups (CSV is optional).
  playbookInputQuery:
- key: AutoUnIsolation
  value:
    simple: "Yes"
  required: false
  description: By providing "Yes" in this playbook input will activated the "Unisolate
    Endpoint - Generic".
  playbookInputQuery:
- key: Endpoint_ip
  value: {}
  required: false
  description: The IP of the endpoint which is involved in the investigation.
  playbookInputQuery:
outputs: []
tests:
- Endpoint Malware Investigation - Generic - Test
fromversion: 6.0.0
