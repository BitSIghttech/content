commonfields:
  id: script-JiraChangeTransition
  version: -1
vcShouldKeepItemLegacyProdMachine: false
name: script-JiraChangeTransition
script: |+
  import json
  def main():
      incident = demisto.incidents()[0]

      custom_fields = incident.get('CustomFields')
      chosen_transition = custom_fields.get("jiratransitions")
      incident_id = incident.get('dbotMirrorId')
      demisto.executeCommand('jira-edit-issue',
      {'issueId': incident_id, "transition": chosen_transition})
      jira_status = demisto.executeCommand('jira-get-issue', {'issueId': incident_id})[0]["Contents"]["fields"]["status"]["name"]
      demisto.executeCommand('setIncident', {'jirastatus': jira_status})
      demisto.executeCommand('setIncident', {'jiratransitions': 'Select'})


  if __name__ in ["__main__", "builtin", "builtins"]:
    main()

type: python
tags:
- field-change-triggered
enabled: true
scripttarget: 0
subtype: python3
pswd: ""
runonce: false
dockerimage: demisto/python3:3.9.1.15759
runas: DBotWeakRole
