id: carbonBlackDefenseV2TestPlaybook
version: -1
fromversion: 5.0.0
vcShouldKeepItemLegacyProdMachine: false
name: carbonBlackDefenseV2TestPlaybook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: cd5ed0a7-46bf-4413-8b05-3ea5ffd9be7b
    type: start
    task:
      id: cd5ed0a7-46bf-4413-8b05-3ea5ffd9be7b
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 46b067d5-1c0e-4285-8576-0b431f298038
    type: regular
    task:
      id: 46b067d5-1c0e-4285-8576-0b431f298038
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
      - "65"
      - "66"
      - "61"
      - "64"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: f1b92789-e7e4-42d3-8656-33c8f1c682b9
    type: regular
    task:
      id: f1b92789-e7e4-42d3-8656-33c8f1c682b9
      version: -1
      name: cbd-get-alert-details
      script: '|||cbd-get-alert-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      alertId:
        complex:
          root: CarbonBlackDefense.Alert
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: d31b7e71-c866-4850-848d-ccedfce2ae37
    type: condition
    task:
      id: d31b7e71-c866-4850-848d-ccedfce2ae37
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "70"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Alert
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: CarbonBlackDefense.Alert
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 29c2eac9-a4bf-4ed7-897c-7c5c8e6fbb46
    type: regular
    task:
      id: 29c2eac9-a4bf-4ed7-897c-7c5c8e6fbb46
      version: -1
      name: cbd-device-search
      script: '|||cbd-device-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      device_id: {}
      end_time: {}
      os: {}
      query: {}
      start_time: {}
      status: {}
      target_priority: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: f9ab831d-bbf9-41b5-8c99-54b6fe8c249b
    type: regular
    task:
      id: f9ab831d-bbf9-41b5-8c99-54b6fe8c249b
      version: -1
      name: cbd-get-policies
      script: '|||cbd-get-policies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 280656e0-b9fa-44d7-805d-5aa8d77b24a6
    type: regular
    task:
      id: 280656e0-b9fa-44d7-805d-5aa8d77b24a6
      version: -1
      name: cbd-get-policy
      script: '|||cbd-get-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: e0d14c57-96e3-488d-81d2-51902a669941
    type: condition
    task:
      id: e0d14c57-96e3-488d-81d2-51902a669941
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: name
            iscontext: true
          right:
            value:
              simple: Demisto nightly test
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 92ef1d44-108f-4c6b-8f0c-31a00238a94e
    type: regular
    task:
      id: 92ef1d44-108f-4c6b-8f0c-31a00238a94e
      version: -1
      name: cbd-set-policy
      script: '|||cbd-set-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      keyValue:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: "{\n    \"policyInfo\": {\n        \"description\": \"A
                    policy created for the test playbook for Demisto\",\n        \"name\":
                    \"Demisto test after set policy\",\n        \"id\": "
              suffix:
                value:
                  simple: |-
                    ,
                            "policy": {
                                "sensorSettings": [
                                    {
                                        "name": "SHOW_UI",
                                        "value": "false"
                                    }
                                ]
                            },
                            "priorityLevel": "LOW"
                        }
                    }
      policy:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 9afea3f0-7b72-4745-8a47-08a7d644f712
    type: regular
    task:
      id: 9afea3f0-7b72-4745-8a47-08a7d644f712
      version: -1
      name: cbd-create-policy
      script: '|||cbd-create-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      description:
        simple: A policy created for the test playbook for Demisto
      name:
        simple: Demisto nightly test
      policy:
        simple: '{}'
      priorityLevel:
        simple: MEDIUM
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: 1e9acfcd-6573-4ff1-8c5f-b1ed30283686
    type: regular
    task:
      id: 1e9acfcd-6573-4ff1-8c5f-b1ed30283686
      version: -1
      name: cbd-delete-policy
      script: '|||cbd-delete-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: 9236e46c-234f-402b-8e7b-cfa442af94d3
    type: regular
    task:
      id: 9236e46c-234f-402b-8e7b-cfa442af94d3
      version: -1
      name: cbd-update-policy
      script: '|||cbd-update-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      description:
        simple: A policy created for the test playbook for Demisto
      id:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      name:
        simple: Demisto test after update policy
      policy:
        simple: '{"sensorSettings": [{"name": "SHOW_UI", "value": "false"}]}'
      priorityLevel:
        simple: MEDIUM
      priorityLevl:
        simple: MEDIUM
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: c47076d8-85f0-408a-8a88-0129365a0129
    type: regular
    task:
      id: c47076d8-85f0-408a-8a88-0129365a0129
      version: -1
      name: cbd-add-rule-to-policy
      script: '|||cbd-add-rule-to-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      action:
        simple: TERMINATE
      id:
        simple: "1"
      operation:
        simple: RANSOM
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      required:
        simple: "true"
      type:
        simple: REPUTATION
      value:
        simple: COMPANY_BLACK_LIST
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 1ecf9dbe-a1bc-4aea-81a6-739191f0bc5c
    type: regular
    task:
      id: 1ecf9dbe-a1bc-4aea-81a6-739191f0bc5c
      version: -1
      name: cbd-update-rule-in-policy
      description: Update an existing rule with a new rule. Please note that system
        policies cannot be modified.
      script: '|||cbd-update-rule-in-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      action:
        simple: TERMINATE
      id:
        simple: "3"
      operation:
        simple: RANSOM
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      required:
        simple: "false"
      type:
        simple: REPUTATION
      value:
        simple: COMPANY_BLACK_LIST
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 5daf4deb-1861-43b7-8656-f397a81905ab
    type: regular
    task:
      id: 5daf4deb-1861-43b7-8656-f397a81905ab
      version: -1
      name: cbd-delete-rule-from-policy
      script: '|||cbd-delete-rule-from-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      ruleId:
        simple: "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 02ad8687-7154-41f8-8739-c644e481bcb0
    type: regular
    task:
      id: 02ad8687-7154-41f8-8739-c644e481bcb0
      version: -1
      name: cbd-device-quarantine
      script: '|||cbd-device-quarantine'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: bf3d88de-18ec-4230-84ef-81492c967443
    type: regular
    task:
      id: bf3d88de-18ec-4230-84ef-81492c967443
      version: -1
      name: cbd-device-background-scan
      script: '|||cbd-device-background-scan'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 9a43fe0a-27a6-4ef8-8a1a-dd6738a1ac85
    type: regular
    task:
      id: 9a43fe0a-27a6-4ef8-8a1a-dd6738a1ac85
      version: -1
      name: cbd-device-background-scan-stop
      script: '|||cbd-device-background-scan-stop'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: bebdfced-e489-4f47-8f63-9156b5dd1ea7
    type: regular
    task:
      id: bebdfced-e489-4f47-8f63-9156b5dd1ea7
      version: -1
      name: cbd-device-bypass
      script: '|||cbd-device-bypass'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 565126f3-af1f-4f20-8f96-f8183e42e05b
    type: regular
    task:
      id: 565126f3-af1f-4f20-8f96-f8183e42e05b
      version: -1
      name: cbd-device-unbypass
      script: '|||cbd-device-unbypass'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: 6137acbe-9917-4086-8403-95f1b82ea7ee
    type: regular
    task:
      id: 6137acbe-9917-4086-8403-95f1b82ea7ee
      version: -1
      name: cbd-device-policy-update
      script: '|||cbd-device-policy-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
      policy_id:
        complex:
          root: inputs.default_policy
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: cfb62d00-bbf7-4b5b-8d5f-b0385ff4526b
    type: regular
    task:
      id: cfb62d00-bbf7-4b5b-8d5f-b0385ff4526b
      version: -1
      name: cbd-device-update-sensor-version
      script: '|||cbd-device-update-sensor-version'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
      sensor_version:
        complex:
          root: inputs.sensor_version
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: bb082257-8580-4819-8b91-b4e609aeb672
    type: title
    task:
      id: bb082257-8580-4819-8b91-b4e609aeb672
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: bbac0056-0125-4ab9-8bd8-3119878ae6ba
    type: condition
    task:
      id: bbac0056-0125-4ab9-8bd8-3119878ae6ba
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: bfe3ddca-d0ef-484e-8384-a9ffbb95c99b
    type: condition
    task:
      id: bfe3ddca-d0ef-484e-8384-a9ffbb95c99b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThan
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: id
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "52":
    id: "52"
    taskid: af912983-448e-46ea-8769-f6ad2d8d405f
    type: condition
    task:
      id: af912983-448e-46ea-8769-f6ad2d8d405f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CarbonBlackDefense.Device
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: 562ba69c-7125-4fe4-86f4-15c2f0bf28bc
    type: title
    task:
      id: 562ba69c-7125-4fe4-86f4-15c2f0bf28bc
      version: -1
      name: Test policies commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: fd3fdcd9-88f9-4ae8-84b1-330587e3e5a1
    type: title
    task:
      id: fd3fdcd9-88f9-4ae8-84b1-330587e3e5a1
      version: -1
      name: Test events commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: 9d4157ba-ec30-44f8-8b84-1199ec7aeb75
    type: title
    task:
      id: 9d4157ba-ec30-44f8-8b84-1199ec7aeb75
      version: -1
      name: Test devices commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: 7847b315-7a70-4d2e-80bd-af0900e57127
    type: title
    task:
      id: 7847b315-7a70-4d2e-80bd-af0900e57127
      version: -1
      name: Test alerts commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: 09ff0f88-11ce-4ca9-83bd-5514c6f56e3d
    type: title
    task:
      id: 09ff0f88-11ce-4ca9-83bd-5514c6f56e3d
      version: -1
      name: Test processes commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: 2cefa18a-3c32-4312-815e-f69e08bd17f4
    type: title
    task:
      id: 2cefa18a-3c32-4312-815e-f69e08bd17f4
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "68":
    id: "68"
    taskid: 1e9b9947-db58-4c35-88c6-58bccaba7861
    type: title
    task:
      id: 1e9b9947-db58-4c35-88c6-58bccaba7861
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: 92b3e844-b535-4fd1-824f-0b6567838c0a
    type: title
    task:
      id: 92b3e844-b535-4fd1-824f-0b6567838c0a
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "70":
    id: "70"
    taskid: 6621d4c8-04cd-4ae0-8633-8a6774f5b6e1
    type: title
    task:
      id: 6621d4c8-04cd-4ae0-8633-8a6774f5b6e1
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "78":
    id: "78"
    taskid: 8f82799f-04e5-4d64-8881-806e83626ede
    type: condition
    task:
      id: 8f82799f-04e5-4d64-8881-806e83626ede
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: name
            iscontext: true
          right:
            value:
              simple: Demisto test after update policy
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "79":
    id: "79"
    taskid: 2aefc4e8-f53d-4e91-8567-f19f00a1acd0
    type: regular
    task:
      id: 2aefc4e8-f53d-4e91-8567-f19f00a1acd0
      version: -1
      name: cbd-device-unquarantine
      description: Unquarantine the device
      script: '|||cbd-device-unquarantine'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "81":
    id: "81"
    taskid: 776ae6d7-ff5e-446f-8ca8-42325b6adb2d
    type: regular
    task:
      id: 776ae6d7-ff5e-446f-8ca8-42325b6adb2d
      version: -1
      name: cbd-alerts-search
      description: Alert search request. Multiple pathways support similar request
        body schemas. (CbAnalytics/devicecontrol/all)
      script: '|||cbd-alerts-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      category: {}
      device_id:
        complex:
          root: inputs.our_sensor
      device_username: {}
      first_event_time: {}
      policy_id: {}
      process_sha256: {}
      query: {}
      reputation: {}
      rows:
        simple: "1"
      start: {}
      tag: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "82":
    id: "82"
    taskid: a30a6720-7a0e-41d6-8f84-aed64195eeeb
    type: condition
    task:
      id: a30a6720-7a0e-41d6-8f84-aed64195eeeb
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CarbonBlackDefense.Alert
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "83":
    id: "83"
    taskid: 5cd3c54e-b225-4764-8445-5d3f16a5c3b3
    type: playbook
    task:
      id: 5cd3c54e-b225-4764-8445-5d3f16a5c3b3
      version: -1
      name: Carbon Black Defense Find Events
      playbookName: 5cd3c54e-b225-4764-8445-5d3f16a5c3b3
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "85"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "84":
    id: "84"
    taskid: 0c391adb-a44d-472a-8c12-09ac083153a8
    type: condition
    task:
      id: 0c391adb-a44d-472a-8c12-09ac083153a8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: name
            iscontext: true
          right:
            value:
              simple: Demisto test after set policy
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "85":
    id: "85"
    taskid: dab05232-b891-405f-8eb7-b1291edf522c
    type: playbook
    task:
      id: dab05232-b891-405f-8eb7-b1291edf522c
      version: -1
      name: Carbon Black Defense Find Event Details
      playbookName: dab05232-b891-405f-8eb7-b1291edf522c
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "86":
    id: "86"
    taskid: 8acb8dc0-371b-436f-8c71-3aaf5c7c9e30
    type: playbook
    task:
      id: 8acb8dc0-371b-436f-8c71-3aaf5c7c9e30
      version: -1
      name: Carbon Black Defense Find Processes
      playbookName: 8acb8dc0-371b-436f-8c71-3aaf5c7c9e30
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2980,
        "width": 2100,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: our_sensor
  value:
    simple: "3925348"
  required: true
  description: ""
  playbookInputQuery: null
- key: default_policy
  value:
    simple: "6525"
  required: true
  description: ""
  playbookInputQuery: null
- key: sensor_version
  value:
    simple: '{ "OTHER": "1.2.3.4" }'
  required: true
  description: ""
  playbookInputQuery: null
outputs: []
