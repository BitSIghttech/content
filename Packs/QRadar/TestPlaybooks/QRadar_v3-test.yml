id: QRadar_v3-test
version: -1
name: QRadar_v3-test
description: QRadar_v3 test playbook. Tests commands of QRadar, validates outputs
  and expected behaviour.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 00b8ca70-3265-4da8-84d4-21fdfe88b727
    type: start
    task:
      id: 00b8ca70-3265-4da8-84d4-21fdfe88b727
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 5b729172-ac53-4aad-81ad-f3db3b3070a6
    type: regular
    task:
      id: 5b729172-ac53-4aad-81ad-f3db3b3070a6
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 3415e77d-3ae9-4b80-897c-69633599a4d8
    type: regular
    task:
      id: 3415e77d-3ae9-4b80-897c-69633599a4d8
      version: -1
      name: Offense List
      description: Gets offenses from QRadar.
      script: '|||qradar-offenses-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      enrichment:
        simple: IPs
      fields: {}
      filter:
        simple: id between 15 and 16
      offense_id: {}
      range: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: ef416ec3-3564-42fc-8eb2-aa311af925dd
    type: condition
    task:
      id: ef416ec3-3564-42fc-8eb2-aa311af925dd
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.StartTime
            iscontext: true
          right:
            value:
              simple: "2021-02-15T14:24:11.536000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.StartTime
            iscontext: true
          right:
            value:
              simple: "2021-02-15T13:21:36.537000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
          right:
            value:
              simple: "false"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
          right:
            value:
              simple: "true"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
          right:
            value:
              simple: "false"
      - - operator: notContainsGeneral
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
          right:
            value:
              simple: "true"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Magnitude
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Credibility
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: "15"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: "16"
      - - operator: hasLength
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Rules.name
            iscontext: true
          right:
            value:
              simple: Fake port scan
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Rules.name
            iscontext: true
          right:
            value:
              simple: Multiple Login Failures for Single Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
          right:
            value:
              simple: Source IP
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
          right:
            value:
              simple: Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Status
            iscontext: true
          right:
            value:
              simple: OPEN
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 89f42aa3-a5c9-460e-8c42-197474ec5db4
    type: title
    task:
      id: 89f42aa3-a5c9-460e-8c42-197474ec5db4
      version: -1
      name: Test Playbook Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: e3d82038-1657-43be-8cdc-408e5f09f767
    type: regular
    task:
      id: e3d82038-1657-43be-8cdc-408e5f09f767
      version: -1
      name: Update Offense
      description: Update an offense.
      script: '|||qradar-offense-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      assigned_to:
        simple: demisto
      closing_reason_id: {}
      enrichment: {}
      fields: {}
      follow_up:
        simple: "true"
      offense_id:
        simple: "14"
      protected:
        simple: "true"
      status: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: f73dc6cd-51a1-4318-8d2f-c8f8d32aeab4
    type: regular
    task:
      id: f73dc6cd-51a1-4318-8d2f-c8f8d32aeab4
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 5c1ba3fd-e11d-4dfb-8d4c-6bc954f8db2b
    type: condition
    task:
      id: 5c1ba3fd-e11d-4dfb-8d4c-6bc954f8db2b
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: "14"
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.AssignedTo
            iscontext: true
          right:
            value:
              simple: demisto
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.ClosingReason
            iscontext: true
          right:
            value:
              simple: Non-Issue
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.Status
            iscontext: true
          right:
            value:
              simple: CLOSED
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
          right:
            value:
              simple: Source IP
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: fe40585b-3da8-4952-8823-91665d5b6e75
    type: regular
    task:
      id: fe40585b-3da8-4952-8823-91665d5b6e75
      version: -1
      name: Create Note To Offense
      description: Retrieve a list of notes for an offense.
      script: '|||qradar-offense-note-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      fields: {}
      note_text:
        simple: Note Regarding The Offense
      offense_id:
        simple: "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 2228b887-0104-4ef9-81ae-c6095673c53d
    type: condition
    task:
      id: 2228b887-0104-4ef9-81ae-c6095673c53d
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: demisto'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 878b3ecd-11b8-472a-8aef-03534e4cdcbf
    type: regular
    task:
      id: 878b3ecd-11b8-472a-8aef-03534e4cdcbf
      version: -1
      name: Note List
      description: Create a note on an offense.
      script: '|||qradar-offense-notes-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      fields: {}
      filter: {}
      note_id: {}
      offense_id:
        simple: "14"
      range:
        simple: 0-1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: a1a9291e-565b-4ac8-89fa-1581f318b78f
    type: condition
    task:
      id: a1a9291e-565b-4ac8-89fa-1581f318b78f
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: demisto'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: f6670728-84f1-472b-8c44-f81eb830dd28
    type: regular
    task:
      id: f6670728-84f1-472b-8c44-f81eb830dd28
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 76786171-e71e-4052-8caf-cb0e8b7b0cb5
    type: regular
    task:
      id: 76786171-e71e-4052-8caf-cb0e8b7b0cb5
      version: -1
      name: Get Closing Reasons List
      description: Retrieve a list of offense closing reasons.
      script: '|||qradar-closing-reasons'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      closing_reason_id: {}
      fields: {}
      filter:
        simple: id <= 2
      include_deleted: {}
      include_reserved: {}
      range: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 418e0a48-f733-4ed9-8795-22a3eeac13e3
    type: condition
    task:
      id: 418e0a48-f733-4ed9-8795-22a3eeac13e3
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: QRadar.ClosingReason.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.ClosingReason.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.ClosingReason.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.ClosingReason.Name
            iscontext: true
          right:
            value:
              simple: False-Positive, Tuned
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.ClosingReason.Name
            iscontext: true
          right:
            value:
              simple: Non-Issue
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 2f40bb35-6d84-4270-862c-a4c3176d36c9
    type: regular
    task:
      id: 2f40bb35-6d84-4270-862c-a4c3176d36c9
      version: -1
      name: Rules List
      description: Retrieves a list of rules.
      script: '|||qradar-rules-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      fields: {}
      filter:
        simple: id between 100001 AND 100006
      range:
        simple: 0-5
      rule_id: {}
      rule_type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: 2201587c-1afa-44a8-8e76-7a92382320eb
    type: condition
    task:
      id: 2201587c-1afa-44a8-8e76-7a92382320eb
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Name
            iscontext: true
          right:
            value:
              simple: Devices with High Event Rates
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.CreationDate
            iscontext: true
          right:
            value:
              simple: "2007-08-09T14:38:27.862000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Origin
            iscontext: true
          right:
            value:
              simple: SYSTEM
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Type
            iscontext: true
          right:
            value:
              simple: EVENT
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100001"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100003"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100006"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: acfcde04-3157-4b2e-858e-7e8c654aaddd
    type: regular
    task:
      id: acfcde04-3157-4b2e-858e-7e8c654aaddd
      version: -1
      name: Group Rule List
      description: Retrieves a list of the rule groups.
      script: '|||qradar-rule-groups-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      fields: {}
      filter: {}
      range:
        simple: 0-0
      rule_group_id:
        simple: "125"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 6f8839df-2239-4348-8f77-74c1805e8b31
    type: condition
    task:
      id: 6f8839df-2239-4348-8f77-74c1805e8b31
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.ID
            iscontext: true
          right:
            value:
              simple: "125"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Name
            iscontext: true
          right:
            value:
              simple: Asset Reconciliation Exclusion
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Type
            iscontext: true
          right:
            value:
              simple: RULE_GROUP
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 15007c7a-0574-4847-864b-fff28ff4d783
    type: regular
    task:
      id: 15007c7a-0574-4847-864b-fff28ff4d783
      version: -1
      name: Assets List
      description: Retrieves assets list.
      script: '|||qradar-assets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      asset_id:
        simple: "1007"
      fields: {}
      filter: {}
      range: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 6d08b5b8-b507-453b-876c-b310b9c9bb42
    type: condition
    task:
      id: 6d08b5b8-b507-453b-876c-b310b9c9bb42
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Asset.ID
            iscontext: true
          right:
            value:
              simple: "1007"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Asset.DomainID
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.Users.first_seen_profiler
            iscontext: true
          right:
            value:
              simple: "2021-02-02T19:05:12.138000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.Properties.name
            iscontext: true
          right:
            value:
              simple: Unified Name
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.Users.username
            iscontext: true
          right:
            value:
              simple: Administrator
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.Users.id
            iscontext: true
          right:
            value:
              simple: "1007"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.Users.first_seen_profiler
            iscontext: true
          right:
            value:
              simple: "2021-02-02T19:05:12.138000+00:00"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 3ad17647-1aa7-40d3-8e7e-4ed9b3d67389
    type: regular
    task:
      id: 3ad17647-1aa7-40d3-8e7e-4ed9b3d67389
      version: -1
      name: Create Reference Set
      description: Create a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      element_type:
        simple: DATE
      fields: {}
      ref_name:
        simple: Test-Reference-Name
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: c64ec459-2c51-4bb3-8325-a48862406af2
    type: condition
    task:
      id: c64ec459-2c51-4bb3-8325-a48862406af2
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeToLive
            iscontext: true
          right:
            value:
              simple: 0 years 0 mons 1 days 0 hours 0 mins 0.00 secs
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.ElementType
            iscontext: true
          right:
            value:
              simple: DATE
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: db96a955-aca8-4605-8c21-73d1caf10594
    type: regular
    task:
      id: db96a955-aca8-4605-8c21-73d1caf10594
      version: -1
      name: Get Reference Details
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      fields: {}
      filter: {}
      range: {}
      ref_name:
        simple: Test-Reference-Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: 2fcc6f83-e178-447b-82bd-e95ff4bd9999
    type: regular
    task:
      id: 2fcc6f83-e178-447b-82bd-e95ff4bd9999
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: 990035a5-4f45-41c9-81ae-cdc185d33c16
    type: regular
    task:
      id: 990035a5-4f45-41c9-81ae-cdc185d33c16
      version: -1
      name: Add Value To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      date_value:
        simple: "True"
      fields: {}
      ref_name:
        simple: Test-Reference-Name
      source: {}
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 9c44ad54-78a6-4f27-85fb-65df23dbe49b
    type: condition
    task:
      id: 9c44ad54-78a6-4f27-85fb-65df23dbe49b
      version: -1
      name: Validate Outputs, With New Element Count
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Data.Value
            iscontext: true
          right:
            value:
              simple: "1607775132000"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: 25799118-fdd0-49d3-81a9-352394a4c2ac
    type: regular
    task:
      id: 25799118-fdd0-49d3-81a9-352394a4c2ac
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: 19801969-e09d-4136-8992-6ae52995eafb
    type: regular
    task:
      id: 19801969-e09d-4136-8992-6ae52995eafb
      version: -1
      name: Delete Reference Set Value
      description: Remove a value from a reference set.
      script: QRadar_v3|||qradar-reference-set-value-delete
      type: regular
      iscommand: true
      brand: QRadar_v3
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 7b28bc2c-77f2-453f-8ba2-de3e950ff5c6
    type: regular
    task:
      id: 7b28bc2c-77f2-453f-8ba2-de3e950ff5c6
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: 8309ad2d-bf33-4f90-851b-13e9e870e7ac
    type: regular
    task:
      id: 8309ad2d-bf33-4f90-851b-13e9e870e7ac
      version: -1
      name: Get Reference With The Deleted Value
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      fields: {}
      filter: {}
      range: {}
      ref_name:
        simple: Test-Reference-Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 8ab5c543-5e2e-4831-8303-855058e55bb6
    type: condition
    task:
      id: 8ab5c543-5e2e-4831-8303-855058e55bb6
      version: -1
      name: Validate Outputs, Validate Element Count Decreased
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: 92f58ec7-d5d5-4cb2-8f8d-abae05602636
    type: regular
    task:
      id: 92f58ec7-d5d5-4cb2-8f8d-abae05602636
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      purge_only: {}
      ref_name:
        simple: Test-Reference-Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: b99019e9-4744-4bf4-8ebc-69cf5d5f5fe6
    type: regular
    task:
      id: b99019e9-4744-4bf4-8ebc-69cf5d5f5fe6
      version: -1
      name: Get Domains List
      description: Gets the list of domains. You must have the System Administrator
        or Security Administrator permissions to call this endpoint if you are trying
        to retrieve the details of all domains. You can retrieve details of domains
        that are assigned to your Security Profile without having the System Administrator
        or Security Administrator permissions. If you do not have the System Administrator
        or Security Administrator permissions, then for each domain assigned to your
        security profile you can only view the values for the id and name fields.
        All other values return null.
      script: '|||qradar-domains-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      domain_id: {}
      fields: {}
      filter: {}
      range: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: 832cec95-79a1-43a5-85d4-2e1fc73dc25c
    type: condition
    task:
      id: 832cec95-79a1-43a5-85d4-2e1fc73dc25c
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Domains.ID
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 342bcbdc-b330-4305-8c0e-40aef80b93b3
    type: regular
    task:
      id: 342bcbdc-b330-4305-8c0e-40aef80b93b3
      version: -1
      name: Geolocations For IPs
      description: Retrieves the MaxMind geoip data for the given IP address.
      script: '|||qradar-geolocations-for-ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      fields: {}
      ips:
        simple: 1.2.3.4,1.2.3.5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 332eaf0c-37bd-494b-871a-873a4c376006
    type: condition
    task:
      id: 332eaf0c-37bd-494b-871a-873a4c376006
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.5
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.CityName
            iscontext: true
          right:
            value:
              simple: Mukilteo
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.ContinentName
            iscontext: true
          right:
            value:
              simple: NorthAmerica
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationLongitude
            iscontext: true
          right:
            value:
              simple: "-122.3042"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationTimezone
            iscontext: true
          right:
            value:
              simple: America/Los_Angeles
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PhysicalCountryName
            iscontext: true
          right:
            value:
              simple: United States
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PostalCode
            iscontext: true
          right:
            value:
              simple: "98275"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: 9e380ee7-7829-43c4-88da-f150bb2b340e
    type: regular
    task:
      id: 9e380ee7-7829-43c4-88da-f150bb2b340e
      version: -1
      name: Sources List
      description: Retrieves a list of log sources.
      script: '|||qradar-log-sources-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      fields: {}
      filter:
        simple: id=112
      qrd_encryption_algorithm:
        simple: AES128
      qrd_encryption_password: {}
      range: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: bdf0afde-c816-46b2-8cdc-84c869edc36d
    type: condition
    task:
      id: bdf0afde-c816-46b2-8cdc-84c869edc36d
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.ID
            iscontext: true
          right:
            value:
              simple: "112"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.Credibility
            iscontext: true
          right:
            value:
              simple: "5"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.TypeID
            iscontext: true
          right:
            value:
              simple: "12"
      - - operator: isFalse
          left:
            value:
              simple: QRadar.LogSource.Gateway
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: QRadar.LogSource.AutoDiscovered
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "40":
    id: "40"
    taskid: 934b8da7-8bb9-476c-809a-35d4f40a99a9
    type: regular
    task:
      id: 934b8da7-8bb9-476c-809a-35d4f40a99a9
      version: -1
      name: Custom Properties
      description: Retrieves a list of event regex properties.
      script: '|||qradar-get-custom-properties'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      field_name: {}
      fields: {}
      filter:
        simple: id = 129 OR id = 212
      range: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: 0c6c4064-6706-40c7-8930-2e68cdaaaa65
    type: condition
    task:
      id: 0c6c4064-6706-40c7-8930-2e68cdaaaa65
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.name
            iscontext: true
          right:
            value:
              simple: ACF2 rule key
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.username
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.property_type
            iscontext: true
          right:
            value:
              simple: string
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "42":
    id: "42"
    taskid: f9dab62e-b51c-480f-8e82-35c9494c547f
    type: playbook
    task:
      id: f9dab62e-b51c-480f-8e82-35c9494c547f
      version: -1
      name: QRadar_v3 Full Search
      playbookName: QRadar_v3 Full Search
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      interval:
        simple: "1"
      output_path: {}
      query_expression:
        simple: |
          SELECT QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory), CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport, destinationip, destinationport, QIDDESCRIPTION(qid), username, PROTOCOLNAME(protocolid), RULENAME("creEventList"), sourcegeographiclocation, sourceMAC, sourcev6, destinationgeographiclocation, destinationv6, LOGSOURCETYPENAME(devicetype), credibility, severity, magnitude, eventcount, eventDirection, postNatDestinationIP, postNatDestinationPort, postNatSourceIP, postNatSourcePort, preNatDestinationPort, preNatSourceIP, preNatSourcePort, UTF8(payload), starttime, devicetime  FROM events WHERE INOFFENSE(2)  limit 20 START 1605046453426
      range:
        simple: 0-1
      saved_search_id: {}
      timeout:
        simple: "10"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "43":
    id: "43"
    taskid: fe3e7b7f-7b18-4f38-8da5-9e7b400970b7
    type: regular
    task:
      id: fe3e7b7f-7b18-4f38-8da5-9e7b400970b7
      version: -1
      name: Get Saved Searches
      description: Retrieves a list of Ariel saved searches.
      script: '|||qradar-saved-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      fields: {}
      filter: {}
      timeout: {}
      range:
        simple: 0-1
      saved_search_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "44":
    id: "44"
    taskid: 983e9a02-512c-4fec-8c5a-2d3f4d565cad
    type: regular
    task:
      id: 983e9a02-512c-4fec-8c5a-2d3f4d565cad
      version: -1
      name: Get Search IDs
      description: Retrieves the list of Ariel searches IDs. Search status and results
        can be polled by sending search ID to 'qradar-search-status-get' and 'qradar-search-results-get'
        commands.
      script: '|||qradar-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      filter: {}
      range:
        simple: 0-2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 7560,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0
